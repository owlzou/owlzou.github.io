<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ä½è¿ç®—ç¬”è®°</title>
      <link href="2020/11/09/bitwise/"/>
      <url>2020/11/09/bitwise/</url>
      
        <content type="html"><![CDATA[<p>ğŸ“”</p><a id="more"></a><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><table><thead><tr><th>åå­—</th><th>ç”¨æ³•</th><th>è¯´æ˜</th><th>Rust ç”¨æ³•</th></tr></thead><tbody><tr><td>ä½ä¸</td><td><code>A&amp;B</code></td><td>æ¯ä¸€ä½è¿›è¡Œæ¯”è¾ƒï¼Œéƒ½ä¸º 1 çš„æƒ…å†µä¸‹è¯¥ä½ä¸º 1</td><td></td></tr><tr><td>ä½æˆ–</td><td><code>A|B</code></td><td>æ¯ä¸€ä½è¿›è¡Œæ¯”è¾ƒï¼Œåªè¦ä¸€ä¸ªä¸º 1 åˆ™è¯¥ä½ä¸º 1</td><td></td></tr><tr><td>å¼‚æˆ–</td><td><code>A^B</code></td><td>æ¯ä¸€ä½è¿›è¡Œæ¯”è¾ƒï¼Œä¸åŒåˆ™è¯¥ä½ä¸º 1ï¼Œå¦åˆ™ä¸º 0</td><td></td></tr><tr><td>å–å</td><td><code>~A</code></td><td>0 å’Œ 1 å…¨éƒ¨å–å</td><td><code>!A</code></td></tr><tr><td>å·¦ç§»</td><td><code>A&lt;&lt;B</code></td><td>äºŒè¿›åˆ¶åå·¦ç§» B ä½ï¼Œå³åœ¨åé¢æ·»åŠ  B ä¸ª 0ï¼Œç›¸å½“äº <code>A*(2^B)</code></td><td></td></tr><tr><td>å³ç§»</td><td><code>A&gt;&gt;B</code></td><td>äºŒè¿›åˆ¶åå³ç§» B ä½ï¼Œå³å»æ‰æœ€å B ä½ï¼Œç›¸å½“äº <code>A/(2^B)</code></td><td></td></tr></tbody></table><h2 id="è¡¥ç "><a href="#è¡¥ç " class="headerlink" title="è¡¥ç "></a>è¡¥ç </h2><p>è¡¥ç æ˜¯å¸¸ç”¨çš„è¡¨ç¤ºè´Ÿæ•°çš„æ–¹æ³•ï¼Œæ•°å­—ä¸Šæ¥è®²æ˜¯æ¨¡å‡å»ç»å¯¹å€¼ã€‚</p><p>æ­£æ•°çš„è¡¥ç =åŸç ï¼Œè´Ÿæ•°çš„è¡¥ç =ç»å¯¹å€¼å–åååŠ  1ã€‚</p><h2 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h2><ol><li>ä¿ç•™ç‰¹å®šä½ç½®çš„æ•°å­—ï¼š</li></ol><pre><code>a &amp; 0xf</code></pre><p><code>0x</code>æ˜¯åå…­è¿›åˆ¶æ•°çš„å¼€å¤´ï¼Œ <code>0xf</code> è¡¨ç¤ºåå…­è¿›åˆ¶æ•°å­— <code>f</code>ï¼ˆ15ï¼‰ï¼ŒäºŒè¿›åˆ¶çš„ <code>1111</code>ã€‚ <code>a &amp; 0xf</code> åˆ™æ˜¯åªä¿ç•™ <code>a</code>çš„åå››ä½ã€‚</p><ol start="2"><li>2 çš„ n æ¬¡å¹‚</li></ol><p>2 çš„ n æ¬¡å¹‚åœ¨äºŒè¿›åˆ¶ä¸‹ï¼Œä¸º<code>100..00</code>æ¨¡å¼ã€‚ä¾‹ï¼š <code>2=10</code>, <code>4=100</code>, <code>8=1000</code>â€¦â€¦</p><p>è€Œå…¶è¡¥ç ï¼ˆå–ååŠ ä¸€ï¼‰åˆ™åˆšå¥½åªæœ‰æœ€é«˜ä½ç›¸åŒã€‚ä¾‹ï¼š <code>-2=11111110</code> å’Œ <code>2=10</code> ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»å‡ºäº† 2018 å¹´å†™çš„å›¾ç‰‡æµè§ˆå™¨</title>
      <link href="2020/10/12/n-image-viewer/"/>
      <url>2020/10/12/n-image-viewer/</url>
      
        <content type="html"><![CDATA[<p>ä¸å¾—ä¸è¯´ï¼Œå½“å¹´æˆ‘è¿˜å†™è¿‡ QT å•Šâ€¦â€¦</p><a id="more"></a><p>ä»ç§»åŠ¨ç¡¬ç›˜é‡Œçœ‹åˆ°äº†äºŒè¿›åˆ¶åŒ…ï¼Œæƒ³èµ·æ¥äº†å½“å¹´å†™çš„è½¯ä»¶â€¦â€¦ç¬¬ä¸€æ¬¡ä¹Ÿæ˜¯æœ€åä¸€æ¬¡å†™ <code>QT</code>äº†ã€‚</p><p>å†™è¿™ä¸ªå›¾ç‰‡æµè§ˆå™¨çš„åˆè¡·æ˜¯ï¼Œæµè¡Œçš„å›¾ç‰‡æµè§ˆå™¨æ”¯æŒçœ‹<code>psd</code>éƒ½ä¸æ”¯æŒçœ‹<code>ora</code>ã€<code>kra</code>ç­‰æ ¼å¼,æ‰€ä»¥è‡ªå·±å†™äº†ä¸€ä¸ªã€‚ç”¨çš„æ˜¯æœ€åŸå§‹çš„æ–¹æ³•ï¼ˆè§£å‹<code>ora</code>æ–‡ä»¶ï¼Œè·å–é‡Œé¢çš„é¢„è§ˆå›¾åƒï¼‰ã€‚è¿™ç§æ–¹æ³•å½“ç„¶æ˜¯æœ‰é—®é¢˜çš„ï¼šä½†æˆ‘æœ¬èº«ç”¨çš„å›¾ç‰‡å°±ä¸å¤§ï¼Œæ‰€ä»¥èƒ½ç”¨ã€‚ä½†ä¹Ÿå› ä¸ºè¿™ä¸ªåŸå› ä¸€ç›´æ²¡æœ‰æ”¾å‡ºæ¥ï¼Œä»¥åæœ‰æ—¶é—´æ”¹è¿›äº†å†è¯´å§â€¦â€¦ä¸è¿‡ä»¥åç”¨<code>Rust</code>é‡æ–°å†™ä¸€ä¸ªçš„å¯èƒ½æ€§æ›´å¤§ï¼ˆ</p><p>æ”¾å¼ é¢„è§ˆï¼š</p><p><img src="/2020/10/12/n-image-viewer/Snipaste_2020-10-12_16-13-53.png" alt="N Image Viewer"></p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¿— </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Rust ç¬”è®°ï¼ˆå››ï¼‰æ™ºèƒ½æŒ‡é’ˆç­‰</title>
      <link href="2020/10/09/rust-note-4-box/"/>
      <url>2020/10/09/rust-note-4-box/</url>
      
        <content type="html"><![CDATA[<p>ğŸ“” ç®€çº¦æ•´ç†æµç¬”è®°</p><a id="more"></a><h2 id="Box"><a href="#Box" class="headerlink" title="Box"></a>Box</h2><p>ä¹‹å‰çš„ç¬”è®°é‡Œæåˆ°äº†</p><blockquote><p><code>Box&lt;dyn std::error::Error&gt;</code>å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„<code>error</code>ã€‚åœ¨å‡½æ•°ä¸­ï¼Œå¯ä»¥æŠŠå¤šç§ç±»å‹çš„é”™è¯¯å±•æˆæ­¤ä¸€ç§é”™è¯¯ã€‚</p></blockquote><p><a href="https://doc.rust-lang.org/rust-by-example/std/box.html" target="_blank" rel="noopener">Box ç±»å‹</a>å¯ä»¥å°†å…¶ä¸­çš„å€¼åˆ†é…åœ¨å †ä¸Šï¼Œå¹¶è¿”å›æŒ‡å‘å®ƒçš„æŒ‡é’ˆã€‚</p><p>å®ƒæœ€å¸¸ä½¿ç”¨çš„åœºæ™¯æ˜¯ï¼š</p><ul><li>åŒ…è£¹æœªçŸ¥é•¿åº¦çš„ç±»å‹ä»¥ç”¨åœ¨éœ€è¦é™å®šé•¿åº¦çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ï¼ˆBox<T>çš„å¤§å°ï¼šæŒ‡é’ˆå¤§å°ã€‚å› æ­¤å¯ä»¥ç”¨åœ¨é€’å½’å®šä¹‰ä¸­ã€‚ï¼‰</li><li>éœ€è¦è½¬æ¢å¤§é‡æ•°æ®çš„æ‰€æœ‰æƒå¹¶ä¸å¸Œæœ›æ•°æ®è¢«å¤åˆ¶ã€‚</li><li>ä½ åªå¸Œæœ›ç¡®å®šå˜é‡æ˜¯æœ‰æŸç§ç‰¹å¾çš„å˜é‡è€Œå¹¶ä¸åœ¨æ„å®ƒçš„å…·ä½“ç±»å‹ã€‚</li></ul><p>ä½¿ç”¨<code>Box</code>ï¼š</p><pre><code class="rust">let a = Box::new(123);</code></pre><h2 id="Rc"><a href="#Rc" class="headerlink" title="Rc"></a>Rc</h2><p><a href="https://doc.rust-lang.org/rust-by-example/std/rc.html" target="_blank" rel="noopener"><code>Rc</code>ï¼ˆReference Counting)</a> è®°å½•å˜é‡çš„å¤šä¸ªæ‰€æœ‰è€…ã€‚å½“<code>Rc</code>çš„è®¡æ•°ä¸º 0 æ—¶,è¯æ˜æ— æ‰€æœ‰è€…ï¼Œ<strong>æ‰€æœ‰</strong>å€¼éƒ½è¢«åˆ é™¤ã€‚</p><pre><code class="rust">//å»ºç«‹ä¸€ä¸ªRcè®¡æ•°let ori = 3;let a = Rc::new(ori);//clone å¢åŠ Rcè®¡æ•°, æµ…æ‹·è´let b = Rc::clone(&amp;a);</code></pre><h2 id="Arc"><a href="#Arc" class="headerlink" title="Arc"></a>Arc</h2><p>Arc(Atomic Reference Counted),åœ¨çº¿ç¨‹é—´å…±äº«æ‰€æœ‰æƒã€‚</p><pre><code class="rust">use std::sync::Arc;let value = Arc::new(&quot;value&quot;);//åœ¨çº¿ç¨‹ä¸­let value2 = Arc::clone(&amp;value);</code></pre><p>å¦‚æœåªæ”¹å˜å•ä¸ªçº¿ç¨‹ä¸­å…±äº«çš„é‡ï¼Œåˆ™ç”¨ä¸ä¸Š <code>Rc</code>ã€‚</p><h2 id="Cell"><a href="#Cell" class="headerlink" title="Cell"></a>Cell</h2><p><a href="https://doc.rust-lang.org/std/cell/" target="_blank" rel="noopener">Cell</a>åˆ†ä¸º <code>Cell&lt;T&gt;</code> å’Œ <code>RefCell&lt;T&gt;</code>ã€‚</p><p><code>Cell</code>å’Œ <code>RefCell</code> å¯ä»¥åœ¨ä¸å¯å˜ç»“æ„ä¸­æä¾›å¯å˜å˜é‡ã€‚ï¼ˆä»…é™ç»“æ„çš„å†…éƒ¨æ–¹æ³•ï¼‰ã€‚</p><p><code>Cell</code> é€šè¿‡æ“ä½œå€¼æœ¬èº«å®ç°å¯å˜æ€§ï¼Œ <code>RefCell</code> é€šè¿‡æ“ä½œå¼•ç”¨å®ç°ã€‚</p><p><a href="https://doc.rust-lang.org/std/cell/struct.Cell.html" target="_blank" rel="noopener">Cell æ–‡æ¡£</a></p><p>æ–°å»ºä¸€ä¸ª<code>Cell</code>:</p><pre><code class="rust">use std::cell::Celllet a = Cell::new(123);</code></pre><p>ä½¿ç”¨<code>Cell</code>é‡Œçš„æ•°æ®</p><pre><code class="rust">//è¿”å›é‡Œé¢çš„å€¼çš„æ‹·è´a.get();//è®¾ç½®é‡Œé¢çš„æ•°æ®a.set(1);//æ›¿æ¢æ•°æ®å¹¶è¿”å›åŸæ•°æ®a.replace(10);</code></pre><p>æ–°å»ºä¸€ä¸ª<code>RefCell</code>ï¼š</p><pre><code class="rust">use std::cell::RefCelllet b = RefCell::new(123);</code></pre><p>ä½¿ç”¨<code>RefCell</code>é‡Œçš„æ•°æ®</p><pre><code class="rust">b.borrow_mut();b.borrow();</code></pre><p>é€šå¸¸ç»“åˆ <code>Rc</code> ä¸€èµ·ä½¿ç”¨( <code>Rc&lt;RefCell&lt;T&gt;&gt;</code> )ï¼Œè¿™æ ·å°±æœ‰äº†å¤šä¸ªæ‰€æœ‰è€…çš„åŒæ—¶è¿˜èƒ½æ”¹å˜å†…å®¹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rust ç¬”è®°ï¼ˆä¸‰ï¼‰æ¨¡å—å’Œæµ‹è¯•</title>
      <link href="2020/10/05/rust-note-3-module-and-test/"/>
      <url>2020/10/05/rust-note-3-module-and-test/</url>
      
        <content type="html"><![CDATA[<p>ğŸ§ª æŠŠæµ‹è¯•å†™åœ¨æ ‡å‡†é‡Œçš„è¿˜æ˜¯ç¬¬ä¸€æ¬¡è§ï¼ˆå¯èƒ½æ˜¯æˆ‘è§è¯†å¤ªå°‘äº†ï¼‰</p><a id="more"></a><h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>æ€»ä¹‹ï¼Œä¸ºäº†å»ºç«‹å·¥ç¨‹åŒ–çš„æ–‡ä»¶ï¼Œä½¿ç”¨ <code>cargo</code> æ–°å»ºå·¥ç¨‹ã€‚</p><pre><code class="rust">cargo new &lt;å·¥ç¨‹å&gt;cargo new --lib &lt;åº“å&gt;</code></pre><p>å·¥ç¨‹ä¸­çš„ <code>main.rs</code> å’Œ <code>lib.rs</code> æ˜¯æ‰€æœ‰ç›¸å…³æ–‡ä»¶çš„æ ¹æ–‡ä»¶ã€‚</p><p>åˆ©ç”¨ <code>mod</code> å®šä¹‰æ¨¡å—ï¼Œåœ¨æ¨¡å—ä¹‹ä¸­è¿˜èƒ½å†å®šä¹‰æ¨¡å—ã€‚</p><pre><code class="rust">mod my_module{    mod module_in_module{        fn add() {}    }}</code></pre><p>åœ¨æ¨¡å—ä¸­ä½¿ç”¨ <code>pub</code> å…³é”®å­—æ ‡æ˜å…¬å…±æ–¹æ³•ã€‚ç»“æ„ä½“å’Œç»“æ„ä½“å†…çš„å­—æ®µï¼Œ <code>pub</code> æ˜¯åˆ†å¼€çš„ã€‚</p><h3 id="è·¯å¾„"><a href="#è·¯å¾„" class="headerlink" title="è·¯å¾„"></a>è·¯å¾„</h3><ul><li>è°ƒç”¨è·¯å¾„ï¼šä½¿ç”¨ <code>::</code>åˆ†å‰²ã€‚</li><li>ç»å¯¹è·¯å¾„ï¼š <code>crate</code> å¼€å¤´ã€‚ä¾‹ <code>crate::my_module::module_in_module</code>ã€‚</li><li>ç›¸å¯¹è·¯å¾„ï¼š <code>my_module::module_in_module</code>ã€‚</li><li>ä½¿ç”¨ <code>super</code> å¼€å§‹çˆ¶çº§çš„ç›¸å¯¹è·¯å¾„ã€‚</li><li>ç”¨ <code>use</code> ç®€åŒ–åé¢è·¯å¾„çš„ä¹¦å†™ã€‚å¯ä»¥ç”¨ <code>as</code> ç»™äºˆåˆ«åã€‚</li><li>åˆ©ç”¨èŠ±æ‹¬å·è°ƒç”¨åŒçº§ï¼š <code>use std::{cmp::Ordering, io};</code></li><li>åˆ©ç”¨ <code>*</code> å¯¼å…¥æ‰€æœ‰ <code>use std::*;</code></li></ul><h3 id="æ‹†åˆ†"><a href="#æ‹†åˆ†" class="headerlink" title="æ‹†åˆ†"></a>æ‹†åˆ†</h3><p>åœ¨ä¸åŒçš„æ–‡ä»¶å†™åŒä¸€ä¸ªæ¨¡å—çš„å†…å®¹ï¼šåœ¨å£°æ˜æ¨¡å—åä½¿ç”¨ <code>;</code> ï¼Œè¯´æ˜åŠ è½½å…¶ä»–åŒåæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹ã€‚</p><p>ä¾‹,æ–‡ä»¶è·¯å¾„</p><pre><code>â”‚  calculate.rsâ”‚  lib.rsâ”‚  main.rsâ”‚â””â”€calculate        add.rs</code></pre><pre><code class="rust">//src\calculate\add.rspub fn add(a: i32, b: i32) -&gt; i32 {    a + b}</code></pre><pre><code class="rust">//src\calculate.rspub mod add;</code></pre><pre><code class="rust">//src\lib.rspub mod calculate;pub fn call_add()-&gt;i32{    calculate::add::add(1,2)}</code></pre><pre><code class="rust">//src\main.rsuse modul::calculate;fn main() {    println!(&quot;{}&quot;,calculate::add::add(2,2));    println!(&quot;{}&quot;,modul::call_add());}</code></pre><pre><code class="toml">//Cargo.toml...[lib]name = &quot;modul&quot;path = &quot;src/lib.rs&quot;[[bin]]name = &quot;modul&quot;path = &quot;src/main.rs&quot;</code></pre><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><h3 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h3><p>åœ¨å‡½æ•°å‰æ·»åŠ  <code>#[test]</code> è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ç”¨çš„å‡½æ•°ã€‚ä¹‹åè¿è¡Œ <code>cargo test</code> å°±å¯ä»¥æ‰§è¡Œæµ‹è¯•å‡½æ•°ã€‚</p><pre><code class="rust"> #[test] fn test(){ }</code></pre><p>æµ‹è¯•ä¸»è¦åˆ† <code>å•å…ƒæµ‹è¯•</code> å’Œ <code>é›†æˆæµ‹è¯•</code> ã€‚</p><ul><li><p><code>å•å…ƒæµ‹è¯•</code> é€šå¸¸æ˜¯åœ¨æ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªåå­—ä¸º <code>test</code> çš„æ¨¡å—åŒ…å«æµ‹è¯•åŠŸèƒ½ï¼Œä»£ç åœ¨<code>src</code>ç›®å½•å†…ã€‚</p></li><li><p><code>é›†æˆæµ‹è¯•</code> åˆ™æ˜¯çº¯å¤–éƒ¨ä»£ç ã€‚é€šå¸¸éœ€è¦åœ¨å·¥ç¨‹ä¸­å»ºç«‹ä¸€ä¸ª å’Œ <code>src</code> åŒçº§çš„ <code>test</code> æ–‡ä»¶å¤¹ã€‚<code>é›†æˆæµ‹è¯•</code> åªæµ‹è¯• <code>lib</code> ã€‚</p></li></ul><p>åœ¨æ¨¡å—å‰æ·»åŠ  <code>#[cfg(test)]</code> è¡¨æ˜æµ‹è¯•ç”¨æ¨¡å—ã€‚æµ‹è¯•æ¨¡å—åªåœ¨æµ‹è¯•æ—¶ç¼–è¯‘ã€‚</p><pre><code>#[cfg(test)]mod tests {    use super::*; //ä½¿ç”¨è¿™è®©æµ‹è¯•å‡½æ•°ä½¿ç”¨å¤–éƒ¨æ¨¡å—å®šä¹‰çš„ä»£ç     #[test]    fn is_true() {        assert!(true);    }}</code></pre><h3 id="å®"><a href="#å®" class="headerlink" title="å®"></a>å®</h3><p>æ‰§è¡Œæ–­è¨€ï¼š</p><pre><code class="rust">assert!(&lt;è¡¨è¾¾å¼&gt;); //è¿”å›æˆåŠŸæˆ–å¤±è´¥assert_eq!(&lt;è¡¨è¾¾å¼1&gt;,&lt;è¡¨è¾¾å¼2&gt;); //æµ‹è¯•ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯å¦ç›¸ç­‰</code></pre><p>è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ï¼š</p><pre><code class="rust">assert!(false,&quot;é”™è¯¯ä¿¡æ¯ {}&quot;, err);</code></pre><p>å¯¹äºåº”è¯¥ <code>panic</code> çš„å‡½æ•°åœ¨ <code>#[test]</code> ä¸‹ä½¿ç”¨ <code>#[should_panic]</code>ã€‚</p><p>ä½¿ç”¨ <code>#[ignore]</code> å¿½ç•¥æ­¤æµ‹è¯•å‡½æ•°ã€‚</p><h3 id="æ§åˆ¶"><a href="#æ§åˆ¶" class="headerlink" title="æ§åˆ¶"></a>æ§åˆ¶</h3><p><code>cargo test</code> çš„å‚æ•°æœ‰ä½œç”¨äº <code>cargo test</code> æœ¬èº«çš„ï¼Œä¹Ÿæœ‰ä½œç”¨äºç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶çš„ã€‚å¦‚æœæƒ³è¦ä¼ ç»™ç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶å‚æ•°ï¼Œå°†å‚æ•°æ”¾åœ¨åˆ†éš”ç¬¦ <code>--</code> åï¼š <code>cargo test &lt;å‚æ•°&gt; -- &lt;ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶çš„å‚æ•°&gt;</code> ã€‚</p><p>ä¾‹ï¼š <code>cargo test -- --test-threads=1</code> ã€‚</p><table><thead><tr><th>ä½œç”¨äº cargo test çš„å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>&lt;æµ‹è¯•åå­—&gt;</code></td><td>åªè¿è¡Œå‡½æ•°åä¸­åŒ…å«æ­¤åå­—çš„æµ‹è¯•å‡½æ•°/æ¨¡å—</td></tr></tbody></table><table><thead><tr><th>ä½œç”¨äºæµ‹è¯•æ–‡ä»¶çš„å‚æ•°</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>--test-threads=1</code></td><td>æµ‹è¯•çº¿ç¨‹æ•°</td></tr><tr><td><code>--show-output</code></td><td>æ˜¾ç¤ºæµ‹è¯•å‡½æ•°çš„ç»“æœ</td></tr><tr><td><code>--ignored</code></td><td>åªè¿è¡Œè¢«å¿½ç•¥çš„å‡½æ•°</td></tr></tbody></table><p><strong>å‚è€ƒèµ„æ–™</strong></p><ul><li>ä¸»è¦æ˜¯<a href="https://doc.rust-lang.org/book/title-page.html" target="_blank" rel="noopener">ã€ŠThe Bookã€‹</a>çš„è¯»ä¹¦ç¬”è®°ã€‚</li><li><a href="https://github.com/rust-lang/rustlings" target="_blank" rel="noopener">Rustlings</a> çš„åšé¢˜æ„Ÿæƒ³</li><li>å°é¢å›¾ç‰‡ï¼šæ¥è‡ª <a href="https://undraw.co/" target="_blank" rel="noopener">Undraw</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rust ç¬”è®°ï¼ˆäºŒï¼‰å…¶å®ƒç±»å‹</title>
      <link href="2020/10/03/rust-note-2/"/>
      <url>2020/10/03/rust-note-2/</url>
      
        <content type="html"><![CDATA[<p>åŒ¹é…ã€å‘é‡ç»„ã€å“ˆå¸Œè¡¨å’Œé”™è¯¯å¤„ç†ã€‚</p><p>å…ˆè¿‡ä¸€éåŸºç¡€ï¼Œä¹‹åå†™ä¸œè¥¿é‡åˆ°é—®é¢˜å†å•æ‹å‡ºæ¥å†™æ•´åˆåšæ–‡â€¦â€¦è¿™ä¹ˆæƒ³çš„ã€‚</p><p><strong>æœªå®Œ</strong></p><a id="more"></a><h2 id="åŒ¹é…å’Œæšä¸¾"><a href="#åŒ¹é…å’Œæšä¸¾" class="headerlink" title="åŒ¹é…å’Œæšä¸¾"></a>åŒ¹é…å’Œæšä¸¾</h2><p>Option å’Œ Result</p><pre><code class="rust">enum Fruit {    Apple,    Banana,    Pear,    Orange,}fn show_fruit(fruit: Fruit) -&gt; String {    match fruit {        Fruit::Apple =&gt; &quot;apple&quot;.to_string(),        Fruit::Banana =&gt; &quot;banana&quot;.to_string(),        Fruit::Pear =&gt; &quot;pear&quot;.to_string(),        Fruit::Orange =&gt; &quot;orange&quot;.to_string(),    }}fn main() {    let myfavorite = Fruit::Orange;    println!(&quot;my favorite fruit is {}&quot;, show_fruit(myfavorite));}</code></pre><p>å¯¹äºåŒ¹é…æ—¶æ²¡æœ‰åŒ¹é…ä¸Šçš„é¡¹ç›®ç•™ä¸‹çš„é»˜è®¤é€‰é¡¹ï¼š<code>_=&gt;&lt;exp&gt;</code>ï¼Œå’Œ<code>elm</code>ä¸€æ ·ã€‚</p><p>åˆ©ç”¨ç±»å‹é€‰é¡¹æ¥è¿›è¡ŒåŒ¹é…ï¼ˆç±»ä¼¼<code>Elm</code>çš„<code>Maybe</code>ï¼‰ã€‚</p><pre><code class="rust">fn main() {    print_number(Some(32));    print_number(None);}fn print_number(str: Option&lt;i32&gt;) {    match str {        Some(s) =&gt; println!(&quot;ä½ è¾“å…¥çš„æ•°å­—æ˜¯ï¼š{}&quot;, s),        None =&gt; println!(&quot;è¾“å…¥ä¸ºç©ºï¼&quot;)    }}</code></pre><p>å¯ä»¥å¯¹æšä¸¾æˆå‘˜æ·»åŠ å±æ€§æè¿°ï¼š</p><pre><code class="rust">enum Message{    Id(u32),    Position {x:i32,y:i32},    Msg(String),    Color(i32,i32,i32)}match message {    Message::Id(id) =&gt; ...}</code></pre><h3 id="if-let-å’Œ-while-let"><a href="#if-let-å’Œ-while-let" class="headerlink" title="if let å’Œ while let"></a>if let å’Œ while let</h3><p>æœ‰æ—¶éœ€è¦è¿™æ ·çš„ä½¿ç”¨åœºæ™¯</p><pre><code class="rust">if let Some(i) = value {    ...}while let Some(i) = value{    ...}</code></pre><p><code>while let</code> å’Œ <code>if let</code> å°† <code>value</code>è§£æ„åˆ° <code>Some(i)</code> ä¸­ã€‚å¦‚æœ<code>value</code>æ˜¯<code>None</code>åˆ™ä¸ºå¦/è·³è¿‡ã€‚</p><h2 id="å‘é‡ç»„"><a href="#å‘é‡ç»„" class="headerlink" title="å‘é‡ç»„"></a>å‘é‡ç»„</h2><p>Vectors</p><pre><code class="rust">fn main() {    //å‘é‡ç»„    let mut v: Vec&lt;i32&gt; = Vec::new();    //å‘å‘é‡ç»„å†…æ·»åŠ     v.push(1);    //æ ¹æ®å†…å®¹åˆ›å»ºå‘é‡ç»„    let v2 = vec![1, 2, 3];    //è¯»å–æ•°æ®,    let data: &amp;i32 = &amp;v2[0];    let data2: std::option::Option&lt;&amp;i32&gt; = v2.get(0); //å¯èƒ½getåˆ°çš„æ˜¯None}</code></pre><p>è¿­ä»£ï¼š</p><pre><code class="rust">    for i in &amp;v2{        println!(&quot;{}&quot;, i);    }    for i in &amp;mut v {        *i +=1; //æ›´æ”¹å¯å˜å¼•ç”¨æ‰€å¼•ç”¨çš„å€¼ï¼Œä½¿ç”¨è§£é™¤å¼•ç”¨ç¬¦å·ï¼ˆ*ï¼‰        println!(&quot;{}&quot;, i);    }</code></pre><h2 id="å“ˆå¸Œè¡¨"><a href="#å“ˆå¸Œè¡¨" class="headerlink" title="å“ˆå¸Œè¡¨"></a>å“ˆå¸Œè¡¨</h2><pre><code class="rust">//å“ˆå¸Œè¡¨use std::collections::HashMap;fn main() {    let field_name = String::from(&quot;Blue&quot;);    let field_value = String::from(&quot;è“è‰²&quot;);    let mut map = HashMap::new();    //æ’å…¥æ•°æ®    map.insert(field_name, field_value);</code></pre><p>è¯»å–æ•°æ®</p><pre><code class="rust">    //è¯»å–æ•°æ®    let _fav_color = map.get(&amp;String::from(&quot;Blue&quot;));    //æ‰“å°å“ˆå¸Œè¡¨ç»“æ„,å¦‚æœåœ¨ç»“æ„ä½“ä¸­æ‰“å¼€è¿™ç§æ ¼å¼åŒ–éœ€è¦æ‰“å¼€debugï¼ˆ#[derive(Debug)]ï¼‰    println!(&quot;{:?}&quot;, map);    //{&quot;Blue&quot;: &quot;è“è‰²&quot;}</code></pre><p>æ›´æ–°æ•°æ®</p><pre><code class="rust">    //æ›´æ–°æ•°æ®,è¦†ç›–    map.insert(String::from(&quot;Blue&quot;), String::from(&quot;æ€»ä¹‹æ˜¯è“è‰²&quot;));    //æ›´æ–°æ•°æ®ï¼ˆå¦‚æœæ²¡æœ‰å’Œè¯¥é”®ç›¸å…³è”çš„å€¼ï¼‰    map.entry(String::from(&quot;Red&quot;))        .or_insert(String::from(&quot;çº¢è‰²&quot;));    map.entry(String::from(&quot;Blue&quot;))        .or_insert(String::from(&quot;ä¸ä¼šè¢«è¦†ç›–&quot;));    map.entry(String::from(&quot;Yellow&quot;)).or_default(); //æ’å…¥default    println!(&quot;{:?}&quot;, map);    //{&quot;Blue&quot;: &quot;æ€»ä¹‹æ˜¯è“è‰²&quot;, &quot;Red&quot;: &quot;çº¢è‰²&quot;, &quot;Yellow&quot;: &quot;&quot;}</code></pre><p>åˆ é™¤æ•°æ®</p><pre><code class="rust">    //åˆ é™¤æ•°æ®    let blue = map.remove(&amp;String::from(&quot;Blue&quot;)); //è¿”å›å€¼    let red = map.remove_entry(&amp;String::from(&quot;Red&quot;)); //è¿”å›é”®å’Œå€¼    println!(&quot;{:?}&quot;, blue); //Some(&quot;æ€»ä¹‹æ˜¯è“è‰²&quot;)    println!(&quot;{:?}&quot;, red); //Some((&quot;Red&quot;, &quot;çº¢è‰²&quot;))</code></pre><p>éå†æ•°æ®</p><pre><code class="rust">    //éå†    for (key, value) in &amp;map {        println!(&quot;-- {}:{},&quot;, key, value);    }}</code></pre><h2 id="é”™è¯¯å¤„ç†"><a href="#é”™è¯¯å¤„ç†" class="headerlink" title="é”™è¯¯å¤„ç†"></a>é”™è¯¯å¤„ç†</h2><p><code>Rust</code>æœ‰ä¸€ä¸ª<code>panic!</code>å®ã€‚ç¢°åˆ°æ— æ³•å¤„ç†çš„é”™è¯¯æ—¶ï¼Œè¯¥å®è¿è¡Œï¼Œç¨‹åºå°†è¾“å‡ºé”™è¯¯ä¿¡æ¯å¹¶æ¸…ç†å †æ ˆï¼Œé€€å‡ºç¨‹åºã€‚</p><pre><code class="rust">//å¯¹äºå¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œä½¿ç”¨ Result ç±»å‹å¤„ç†ã€‚//enum Result&lt;T, E&gt; {//     Ok(T),//     Err(E),// }fn main() {    let input1 = &quot;abcde&quot;;    let _number: i32 = match input1.parse() {        Ok(num) =&gt; num,        Err(_) =&gt; panic!(&quot;è¯¥å­—ç¬¦ä¸²ä¸æ˜¯æ•°å­—!&quot;),    };    //thread &#39;main&#39; panicked at &#39;è¯¥å­—ç¬¦ä¸²ä¸æ˜¯æ•°å­—!&#39;, ./error.rs:13:19}</code></pre><p>é”™è¯¯çš„å†åŒ¹é…ï¼š<code>error.kind</code>æŸ¥çœ‹é”™è¯¯ç±»å‹ã€‚</p><p>ç®€å†™ï¼š</p><pre><code class="rust">//å¦‚æœå¤±è´¥ä¼šè§¦å‘panic(ç”±unwrapè§¦å‘)let _n1: i32 = String::from(&quot;abced&quot;).parse().unwrap();//thread &#39;main&#39; panicked at &#39;called `Result::unwrap()` on an `Err` value: ParseIntError { kind: InvalidDigit }&#39;, ./error.rs:11:50</code></pre><p>ä½¿ç”¨<code>expect</code>å¯ä»¥æä¾›è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯ã€‚</p><pre><code class="rust">let _n2: i32 = String::from(&quot;abced&quot;).parse().expect(&quot;non-number&quot;);//thread &#39;main&#39; panicked at &#39;non-number: ParseIntError { kind: InvalidDigit }&#39;, ./error.rs:11:50</code></pre><p><code>?</code>æ¥åœ¨<code>Result</code>å‹åé¢ï¼Œå¦‚æœ Ok åˆ™è¿”å›å€¼ï¼Œä¸ç„¶è¿”å›å¹¶ä¼ æ’­ Errï¼ˆé€€å‡ºæ•´ä¸ªå‡½æ•°ï¼‰ã€‚æ‰€ä»¥æ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯<code>Result</code>,ä¾‹å¦‚<code>Ok(())</code>ã€‚</p><pre><code class="rust">use std::num::ParseIntError;fn pars() -&gt; Result&lt;i32, ParseIntError&gt; {    let n3 = &quot;abcde&quot;;    let n4 = n3.parse::&lt;i32&gt;()?;    Ok(n4)}//è°ƒç”¨pars()å¹¶æ‰“å°ç»“æœ//Err(ParseIntError { kind: InvalidDigit })</code></pre><p><code>Box&lt;dyn std::error::Error&gt;</code>å¯ä»¥æ¥å—ä»»ä½•ç±»å‹çš„<code>error</code>ã€‚åœ¨å‡½æ•°ä¸­ï¼Œå¯ä»¥æŠŠå¤šç§ç±»å‹çš„é”™è¯¯å±•æˆæ­¤ä¸€ç§é”™è¯¯ã€‚</p><p><a href="https://doc.rust-lang.org/std/keyword.dyn.html" target="_blank" rel="noopener">dyn</a>æ˜¯<code>trait</code>å¯¹è±¡çš„å‰ç¼€ï¼Œè¯´æ˜å¯¹<code>trait</code>ä¸Šæ–¹æ³•æ˜¯åŠ¨æ€è°ƒç”¨çš„ã€‚</p><h2 id="è¿­ä»£å™¨"><a href="#è¿­ä»£å™¨" class="headerlink" title="è¿­ä»£å™¨"></a>è¿­ä»£å™¨</h2><p>è¿­ä»£å™¨(Iterator)ã€‚å¯å®ç°å¯¹åºåˆ—åŒ–å¯¹è±¡çš„éå†ã€‚<a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" target="_blank" rel="noopener">è¯¦ç»†å¯ç”¨æ–¹æ³•</a></p><p>æ‰€æœ‰<code>Iterator</code>å‡å®ç°ä¸€ä¸ª<code>next</code>æ–¹æ³•ä»¥ç´¢å¼•åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ï¼ˆ<code>Some</code>æˆ–è€…<code>None</code>)ã€‚</p><p>è¿­ä»£å™¨çš„æ¶ˆè€—ï¼šå¯ä»¥ç†è§£ä¸ºè¿­ä»£å™¨å†…éƒ¨ç»´æŠ¤ç€ç›®å‰çš„è¿­ä»£æƒ…å†µã€‚</p><ul><li><code>collect</code>å°†è¿­ä»£å™¨è½¬æ¢å›é›†åˆã€‚æœ‰æ—¶éœ€è¦æ³¨æ˜ç±»å‹ï¼Œä¾‹ <code>a.iter().collect::&lt;String&gt;()</code>ã€‚</li></ul><p><strong>å‚è€ƒèµ„æ–™</strong></p><ul><li>ä¸»è¦æ˜¯<a href="https://doc.rust-lang.org/book/title-page.html" target="_blank" rel="noopener">ã€ŠThe Bookã€‹</a>çš„è¯»ä¹¦ç¬”è®°ã€‚</li><li><a href="https://github.com/rust-lang/rustlings" target="_blank" rel="noopener">Rustlings</a> çš„åšé¢˜æ„Ÿæƒ³</li><li>å°é¢å›¾ç‰‡ï¼š<a href="https://www.pexels.com/photo/red-crab-2235924/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels" target="_blank" rel="noopener">Photo by rompalli harish from Pexels</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rust ç¬”è®°ï¼ˆä¸€ï¼‰åŸºç¡€</title>
      <link href="2020/09/25/rust-note-1/"/>
      <url>2020/09/25/rust-note-1/</url>
      
        <content type="html"><![CDATA[<p>ğŸ“” ç®€çº¦æˆ‘æµè¯­æ³•ç¬”è®°</p><a id="more"></a><h2 id="å¸¸è§„"><a href="#å¸¸è§„" class="headerlink" title="å¸¸è§„"></a>å¸¸è§„</h2><ul><li>æ²¡æœ‰ <code>i++</code> ä¹‹ç±»ã€‚</li><li>æ²¡æœ‰ä¸‰ç›®è¿ç®—ç¬¦ã€‚</li><li>ä»£ç å‘½åè§„èŒƒä½¿ç”¨ <code>snake case</code> ï¼Œå…¨å°å†™å¹¶ä½¿ç”¨ <code>_</code> ä½œåˆ†éš”ã€‚</li><li>æ²¡æœ‰ç”¨åˆ°å´è¦ç•™åœ¨ä»£ç é‡Œçš„å˜é‡åŠ å‰ç¼€ <code>_</code> ï¼Œä¾‹ï¼š <code>_member</code> ã€‚</li></ul><h2 id="ç±»å‹"><a href="#ç±»å‹" class="headerlink" title="ç±»å‹"></a>ç±»å‹</h2><table><thead><tr><th>åç§°</th><th>æ ‡å¿—</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>å¸ƒå°”</td><td>bool</td><td></td></tr><tr><td>å­—ç¬¦</td><td>char</td><td>å®šä¹‰ç”¨å•å¼•å·</td></tr><tr><td>æ•´å½¢</td><td>i*ï¼ˆå¸¦ç¬¦å·ï¼‰ï¼Œu*(æ— ç¬¦å·)</td><td>*å¯ä»¥æ˜¯ 8ï¼Œ16ï¼Œ32ï¼Œ64ï¼Œ128ï¼Œsize(ä¾èµ–äºè¿è¡Œç¨‹åºçš„ç”µè„‘æ¶æ„)</td></tr><tr><td>æµ®ç‚¹</td><td>f*</td><td>*ä¸º 32 æˆ– 64</td></tr><tr><td>å…ƒç»„</td><td>(&lt;ç±»å‹&gt;,&lt;ç±»å‹&gt;)</td><td>ç»„åˆä¸åŒç±»å‹çš„å˜é‡</td></tr><tr><td>æ•°ç»„</td><td>[&lt;ç±»å‹&gt;;&lt;ä¸ªæ•°&gt;]</td><td>å¯ä»¥ä½¿ç”¨ [&lt;å€¼&gt;;&lt;ä¸ªæ•°&gt;] æ¥åˆå§‹åŒ–æ•°ç»„</td></tr></tbody></table><p>å…³äºå­—ç¬¦ä¸²ï¼šé€šå¸¸åˆ›å»ºçš„ç¡¬ç¼–ç å­—ç¬¦ä¸²å±äº<code>&amp;str</code>ï¼Œè€Œåˆ›å»ºå¯å˜å­—ç¬¦ä¸²éœ€è¦ä½¿ç”¨<code>String</code>ã€‚</p><pre><code class="rust">let a = &quot;string&quot;;let b = String::from(&quot;string&quot;);</code></pre><h3 id="å…ƒç»„"><a href="#å…ƒç»„" class="headerlink" title="å…ƒç»„"></a>å…ƒç»„</h3><p>å…ƒç»„æ˜¯å°†å¤šç§ç±»å‹çš„å¤šä¸ªå€¼ç»„åˆä¸ºä¸€ä¸ªå¤åˆç±»å‹çš„ä¸€èˆ¬æ–¹æ³•ã€‚å®ƒçš„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚</p><pre><code class="rust">fn main(){    let tup:(i32,String) = (12, &quot;abc&quot;);}</code></pre><p>å–å‡ºå…ƒç»„ä¸­çš„ç‰©å“éœ€è¦è§£æ„æˆ–è€…ç”¨<code>.</code>å–å€¼ã€‚</p><pre><code class="rust">fn main() {    let tup: (i32, &amp;str) = (12, &quot;abc&quot;);    let (x, y) = tup;    let z = tup.0;    println!(&quot;first value:{} {}&quot;, x, z);    //first value:12 12}</code></pre><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>Rust ä¸­çš„æ•°ç»„æ˜¯å®šé•¿çš„ã€‚å»ºç«‹æ•°ç»„å¯ä»¥ç”¨é€šå¸¸çš„æ–¹æ‹¬å·æ³•ï¼š</p><pre><code class="rust">let arr: [i32; 3] = [1,2,3];</code></pre><p>æˆ–è€…ç”¨åŒä¸€å€¼åˆå§‹åŒ–:</p><pre><code class="rust">let arr = [1;3]; //[1, 1, 1]</code></pre><p>ç”¨äºå¾ªç¯çš„å¿«é€Ÿç´¢å¼•ï¼š</p><pre><code class="rust">for i in 0..4 {        println!(&quot;{}&quot;, i); //0 1 2 3    }</code></pre><p>æ•°ç»„å–å€¼æ–¹æ³•ï¼š</p><pre><code class="rust">fn main() {   let arr: [i32; 3] = [1,2,3];   let first = arr[0];}</code></pre><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><h3 id="å˜é‡å’Œå¸¸é‡"><a href="#å˜é‡å’Œå¸¸é‡" class="headerlink" title="å˜é‡å’Œå¸¸é‡"></a>å˜é‡å’Œå¸¸é‡</h3><p>å˜é‡ä½¿ç”¨ <code>let</code> å®šä¹‰ã€‚é»˜è®¤ä¸å¯å˜ï¼Œå¦‚æœéœ€è¦å¯å˜åˆ™åŠ ä¸Š<code>mut</code>æ ‡å¿—ã€‚<br>ç”¨<code>let</code>å®šä¹‰åŒåå˜é‡å°†è¦†ç›–åŸå…ˆå˜é‡ï¼ˆè¿™å’Œå¯å˜å˜é‡ä¸ä¸€æ ·ï¼‰ã€‚</p><pre><code class="rust">let x = 2;let mut y = 3;let x = 3; //xæœ€ç»ˆç­‰äº3,letä¸èƒ½ä¸¢y = 5;</code></pre><p>å¸¸é‡ä½¿ç”¨<code>const</code>å®šä¹‰ï¼Œå¹¶<strong>å¿…é¡»å£°æ˜ç±»å‹</strong>ã€‚å¸¸é‡ä¸€å®šæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ä¸ç”¨<code>mut</code>ã€‚</p><pre><code class="rust">const c:u32 = 99</code></pre><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>å‡½æ•°ç”¨<code>fn</code>å…³é”®å­—å®šä¹‰ã€‚</p><pre><code class="rust">fn main(){    let result = add(1,3);    println!(&quot;value:{}&quot;,result);}fn add(a:i64,b:i64) -&gt; i64{    a+b}</code></pre><p>å‡½æ•°çš„è¿”å›å€¼ä¸å¤§æ‹¬å·å†…æœ€åçš„è¡¨è¾¾å¼åŒå€¼ã€‚æ³¨æ„ï¼Œè¡¨è¾¾å¼æœ€åä¸å¸¦<strong>åˆ†å·</strong>ï¼Œå¸¦åˆ†å·çš„å±äºå£°æ˜ï¼ˆstatement)ã€‚</p><p>å€Ÿç”¨ä½¿ç”¨<code>&amp;&lt;å˜é‡&gt;</code>ã€‚å¯å˜å€Ÿç”¨ä½¿ç”¨<code>&amp;mut &lt;å˜é‡&gt;</code>ã€‚<strong>åŒæ—¶ä½¿ç”¨</strong>çš„å€Ÿç”¨å˜é‡åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å€Ÿç”¨æˆ–è€…å¤šä¸ªä¸å˜å€Ÿç”¨ã€‚</p><h3 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h3><p>å•è¡Œæ³¨é‡Š <code>//</code>ï¼Œå¤šè¡Œæ³¨é‡Š <code>/**/</code>ã€‚</p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><h3 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h3><p>ä½¿ç”¨ <code>if &lt;exp&gt; {&lt;then&gt;} else if &lt;exp&gt; {&lt;then&gt;} else {&lt;then&gt;}</code>ã€‚</p><p>Rust åœ¨ç¢°åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å—å°±æ‰§è¡Œå¹¶è¿”å›ï¼Œä¸æ£€æŸ¥åé¢çš„å†…å®¹ã€‚</p><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><p>ä¸‰ç§å¾ªç¯æ–¹æ³•ï¼š<code>loop</code>ã€<code>while</code>å’Œ<code>for</code>ã€‚</p><pre><code class="rust">fn main(){    let lo = loop {      println!(&quot;loop!&quot;);      break &quot;loop&quot;; //é€šè¿‡breakç»ˆæ­¢å¾ªç¯å¹¶è¿”å› &quot;loop&quot;    };    println!(&quot;loop:{}&quot;,lo);    let mut n = 3;    while n &gt; 0 {      println!(&quot;while:{}&quot;,n);      n -= 1;    }    let list = [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;];    for i in list.iter(){ //iter()        println!(&quot;for:{}&quot;,i);    }    for i in 1..6 {        println!(&quot;for:{}&quot;,i); //æ‰“å°å‡ºçš„æ˜¯1-5    }}</code></pre><h2 id="åˆ†å‰²"><a href="#åˆ†å‰²" class="headerlink" title="åˆ†å‰²"></a>åˆ†å‰²</h2><p>æ•°ç»„å’Œå­—ç¬¦ä¸²çš„åˆ†å‰²éƒ½æ˜¯å…¶ä¸€éƒ¨åˆ†çš„å¼•ç”¨ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><pre><code class="rust">//æ•°ç»„let a = [1, 2, 3, 4, 5];let slice = &amp;a[1..4]; //[2, 3, 4]//å­—ç¬¦ä¸²let s = String::from(&quot;hello&quot;);let he = &amp;s[0..2];</code></pre><p>åˆ‡ç‰‡çš„æ•°å­—æ˜¯ä» <code>å¼€å§‹</code> åˆ° <code>ç»“æŸ+1</code> ã€‚å¦‚æœæ˜¯ä»ç¬¬ä¸€ä¸ªç´¢å¼•å¼€å§‹ï¼Œ0 å¯ä»¥çœç•¥(<code>[..2]</code>)ã€‚</p><h2 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h2><pre><code class="rust">struct Person{    name:String,    age: u64,}struct Member{    id: u64,    ..Person //ä½¿ç”¨personå†…çš„å®šä¹‰}struct Point(i32,i32) //å…ƒç»„ç»“æ„</code></pre><p>åˆå§‹åŒ–</p><pre><code class="rust">let p = Person {        name: String::from(&quot;Robert&quot;),        age: 8,    };let pt = Point(33,33);//å¦‚æœéœ€è¦ä¸€ä¸ªæ–°ç»“æ„ä½“å’Œç°å­˜çš„æŸä¸ªç»“æ„ä½“ä¸€æ ·ï¼Œä½†ä¿®æ”¹éƒ¨åˆ†æ•°æ®let p1 = Person {    name: String::from(&quot;Alice&quot;),    ..p};</code></pre><p>å®šä¹‰ç”¨äºç»“æ„ä½“çš„æ–¹æ³•ï¼šå¾€å¾€åœ¨å®šä¹‰ç»“æ„ä½“çš„ä¸Šä¸‹æ–‡ï¼Œç”¨<code>self</code>æŒ‡ä»£ç»“æ„ä½“ã€‚</p><pre><code class="rust">fn main(){    struct Point(i32,i32);    impl Point{        fn print(&amp;self){            let Point(x,y) = self;            println!(&quot;(x:{},y:{})&quot;,x,y)        }    }    let pt = Point(33,33);    pt.print();}</code></pre><p><code>impl</code>ä»£è¡¨ implementations ï¼Œ ç”¨äºå®šä¹‰ç±»å‹çš„å®ç°ã€‚</p><h2 id="åˆ‡ç‰‡"><a href="#åˆ‡ç‰‡" class="headerlink" title="åˆ‡ç‰‡"></a>åˆ‡ç‰‡</h2><p>å­—ç¬¦ä¸²<a href="https://doc.rust-lang.org/book/ch04-03-slices.html" target="_blank" rel="noopener">åˆ‡ç‰‡</a>ï¼šå¯¹äºå­—ç¬¦ä¸²ä½ç½®çš„å¼•ç”¨ï¼ˆæ‰€ä»¥æ²¡æœ‰å¯¹åº”çš„æ‰€æœ‰æƒæ¦‚å¿µï¼‰</p><pre><code class="rust">let str = String::from(&quot;Hello&quot;);let he = &amp;str[0..2];println!(&quot;{}&quot;,he);//He//orlet he = &amp;str[..2]; //å¼€å§‹ä¸º0å¯ä»¥å±è”½println!(&quot;{}&quot;,he);//Helet lo = &amp;str[3..]; //ç»“å°¾ä¸ºæœ€åä¹Ÿå¯ä»¥å±è”½println!(&quot;{}&quot;,lo);//lo</code></pre><p><strong>å‚è€ƒèµ„æ–™</strong></p><ul><li>ä¸»è¦æ˜¯<a href="https://doc.rust-lang.org/book/title-page.html" target="_blank" rel="noopener">ã€ŠThe Bookã€‹</a>çš„è¯»ä¹¦ç¬”è®°ã€‚</li><li><a href="https://github.com/rust-lang/rustlings" target="_blank" rel="noopener">Rustlings</a> çš„åšé¢˜æ„Ÿæƒ³</li><li>å°é¢å›¾ç‰‡ï¼š<span>Photo by <a href="https://unsplash.com/@picoftasty?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Mae Mu</a> on <a href="https://unsplash.com/s/photos/crab?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener">Unsplash</a></span></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°† HEX é¢œè‰²å€¼è½¬æ¢ä¸º RGB é¢œè‰²å€¼</title>
      <link href="2020/09/17/elm-note-parser/"/>
      <url>2020/09/17/elm-note-parser/</url>
      
        <content type="html"><![CDATA[<p>ç›®å‰å†™çš„é¡¹ç›®éœ€è¦æŠŠ<code>hex</code>é¢œè‰²è½¬æ¢æˆ<code>rgb</code>çš„å½¢å¼ï¼Œæƒ³èµ·äº†ä¹‹å‰å†™äº†ä¸€åŠå°±æ²¡åŠ¨çš„<code>elm/parser</code>çš„åšæ–‡ï¼Œæ­£å¥½è¶è¿™ä¸ªæœºä¼šå†™å®Œã€‚</p><p>âš ï¸ ä¾æ—§æ˜¯ä¸å®Œæ•´ç¬”è®°ï¼Œåªå†™ç”¨åˆ°çš„éƒ¨åˆ†ã€‚</p><p>ğŸ¯ ç›®æ ‡æ˜¯å°† <code>#9fa0d7</code> è¿™ç§å½¢å¼çš„å­—ç¬¦ä¸²æå–å‡º RGB çš„å€¼ï¼šrgb(159,160,215)</p><a id="more"></a><ul><li><a href="https://github.com/elm/parser" target="_blank" rel="noopener">ğŸ–¥ï¸ <code>elm/parser</code> çš„ GitHub åœ°å€</a></li><li><a href="https://package.elm-lang.org/packages/elm/parser/latest/" target="_blank" rel="noopener">ğŸ“¦ åœ¨<code>elm-package</code>ä¸Šçš„åœ°å€</a></li></ul><h2 id="ç®¡é“æµç¨‹"><a href="#ç®¡é“æµç¨‹" class="headerlink" title="ç®¡é“æµç¨‹"></a>ç®¡é“æµç¨‹</h2><p>åŒ…æ–‡æ¡£é‡Œæä¾›çš„ä¸€ä¸ªä¾‹å­è¯´æ˜äº† parser çš„å·¥ä½œæ–¹æ³•ï¼š</p><pre><code class="elm">point : Parser Pointpoint =  succeed Point    |. symbol &quot;(&quot;    |. spaces    |= float    |. spaces    |. symbol &quot;,&quot;    |. spaces    |= float    |. spaces    |. symbol &quot;)&quot;</code></pre><p>ä¸Šé¢çš„<code>|.</code>ï¼Œ<code>|=</code>ä¹‹ç±»çš„æ˜¯å¤„ç†æ•°æ®çš„æ–¹æ³•ã€‚</p><table><thead><tr><th>ç®¡é“</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>|.</td><td>è§£æå¹¶ç•¥è¿‡ç»“æœ</td></tr><tr><td>|=</td><td>è§£æå¹¶ä¿ç•™ç»“æœï¼Œå·¦ä¾§ç±»å‹è¦æ˜¯<code>Parser (a-&gt;b)</code></td></tr><tr><td>succeed</td><td>ç›´æ¥è¾“å‡ºå†…å®¹ï¼Œç±»å‹æ˜¯<code>a-&gt;Parser a</code></td></tr><tr><td>lazy</td><td>é€’å½’è§£æï¼Œä¾‹å¦‚åœ¨ parser ä¸­åŒ…å« parser</td></tr><tr><td>andThen ,problem</td><td></td></tr></tbody></table><p>æ‰€ä»¥<code>point</code>è§£æå™¨è¡¨ç¤ºçš„æ„æ€å°±æ˜¯æŠ½å–<code>(1,2)</code>ï¼Œ<code>ï¼ˆ33 , 4324)</code>ç±»ä¼¼è¾“å…¥ä¸­çš„ xy å€¼ã€‚</p><p>å¯ä»¥ç›´æ¥ç”¨äºè§£æçš„è§£æå™¨æœ‰:</p><table><thead><tr><th>ç±»å‹</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>int, float, number</td><td>å…¶ä¸­<code>number</code>å¯ä»¥åŒæ—¶è§£æä¸åŒç±»å‹çš„æ•°å­—ç±»å‹ã€‚</td></tr><tr><td>symbol</td><td>ç¬¦å·ï¼Œå¤šç”¨äº<code>(</code>ã€ <code>)</code>ã€ <code>,</code>ç­‰</td></tr><tr><td>end</td><td>æ£€æŸ¥æ˜¯å¦åˆ°è¾¾å­—ç¬¦ä¸²çš„ç»ˆç‚¹ã€‚å¯ä»¥ç”¨äºç¡®ä¿åˆ†æå®Œäº†æ•´ä¸ªå­—ç¬¦ä¸²</td></tr><tr><td>spaces</td><td>åŒ…æ‹¬<code>&lt;ç©ºæ ¼&gt;</code>, <code>\n</code> ,<code>\r</code></td></tr><tr><td>keyword</td><td>è§£æå…³é”®å­—ï¼šå†…å®¹æ˜¯è¿è´¯å®Œæ•´çš„ï¼š n+1 ä½ä¸èƒ½æ˜¯å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿</td></tr><tr><td>variable</td><td>è§£æç±»ä¼¼å˜é‡åçš„å†…å®¹ï¼šæœ‰ç‰¹å®šå¼€å¤´ï¼Œå†…å®¹è¿‡æ»¤ï¼Œæ’é™¤ä¿ç•™å­—</td></tr><tr><td>lineComment ,multiComment</td><td>è§£ææ³¨é‡Šï¼ˆè·³è¿‡å†…å®¹ï¼‰</td></tr></tbody></table><p>å¯¹äºæˆ‘ä»¬çš„éœ€æ±‚ï¼Œé¢œè‰²çš„æœ‰æ•ˆè¾“å…¥æ ¼å¼æ˜¯ <code>\#[\d(a-f)(A-F)]{6}\</code>ã€‚åˆ’åˆ†çš„æ—¶å€™ä¸¤ä¸ªä¸¤ä¸ªä¸€åˆ’å¹¶è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p><pre><code class="elm">type alias Color =    { red : Int    , green : Int    , blue : Int    }hexToColor : Parser InthexToColor =    succeed Color            |. symbol &quot;#&quot;            |= hexToInt            |= hexToInt            |= hexToInt            |. end</code></pre><p>å¿½ç•¥æ‰å‰é¢çš„<code>#</code>ï¼Œç„¶åå®æ–½ 3 ä¸ª<code>hexToInt</code>ï¼ˆæ¯ä¸ªå¤„ç†ä¸¤ä¸ªå­—ç¬¦ï¼‰ï¼Œæ¯ä¸ªéƒ½ä¿ç•™ä¼ è¾“åˆ° Color æ„é€ ä¸­ã€‚</p><h2 id="é€å­—å¤„ç†"><a href="#é€å­—å¤„ç†" class="headerlink" title="é€å­—å¤„ç†"></a>é€å­—å¤„ç†</h2><p>ç”±ä¸Šï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€è¡Œå·²ç»æœ‰äº†ï¼š <code>|. symbol &quot;#&quot;</code>ï¼Œä½†åé¢çš„å°±è¦è‡ªå·±å¤„ç†äº†ã€‚çœ‹æ–‡æ¡£ä½¿ç”¨<code>Chompers</code>ï¼ˆå’€åš¼ï¼Ÿæ„Ÿè§‰åƒæ˜¯åƒè±†äººé‚£æ ·ä¸€ä¸ªä¸€ä¸ªå¤„ç†å¹¶ç§»é™¤ï¼‰ã€‚</p><table><thead><tr><th>åç§°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>chompIf</td><td>å¤„ç†ä¸€ä¸ªé€šè¿‡æµ‹è¯•çš„å­—ç¬¦</td></tr><tr><td>chompWhile</td><td>å¤„ç†è¿ç»­çš„é€šè¿‡æµ‹è¯•çš„å­—ç¬¦</td></tr><tr><td>chompUntil</td><td>å¤„ç†ç›´åˆ°ç¢°åˆ°ç»™å®šçš„å­—ç¬¦</td></tr><tr><td>chompUntilEndOr</td><td>å¤„ç†ç›´åˆ°ç¢°åˆ°ç»™å®šçš„å­—ç¬¦æˆ–ç»“å°¾</td></tr><tr><td>getChompedString,mapChompedString</td><td>å­—é¢æ„æ€ï¼Œä¸Šæ–‡ä¸­çš„ç®¡é“æ–¹æ³•å…¶å®éƒ½æ˜¯ chomp çš„ä¸€ç§ï¼Œæ‰€ä»¥ä½¿ç”¨ symbol å‡½æ•°ä¹Ÿä¼šæ”¶åˆ°</td></tr></tbody></table><p>æ¥ç€ä½¿ç”¨</p><pre><code class="elm">hexToInt : Parser InthexToInt =    Parser.map intFromHexString &lt;|        getChompedString &lt;|            chompIf Char.isHexDigit                |. chompIf Char.isHexDigit</code></pre><ol><li>ç”¨<code>chompIf</code>å¤„ç†ä¸¤ä¸ªå­—ç¬¦</li><li>ç”¨<code>getChompedString</code>æ¥å—è¢« chomp çš„å­—ç¬¦</li><li>æœ€åç”¨ map å°† String è½¬æ¢ä¸º Intï¼Œå…¶ä¸­ç”¨äº†ä¸€ä¸ª hex è½¬ int çš„å‡½æ•°ã€‚</li></ol><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><details><summary>ç‚¹å‡»æŸ¥çœ‹</summary><pre><code class="elm">module Main exposing (main)import Browserimport Html exposing (Html, div, input, text)import Html.Attributes exposing (placeholder, type_)import Html.Events exposing (onInput)import Parser exposing (..)-- MAINmain : Program () Model Msgmain =    Browser.sandbox { init = init, update = update, view = view }-- MODELtype alias Model =    Maybe Colortype alias Color =    { red : Int    , green : Int    , blue : Int    }init : Modelinit =    Nothing-- UPDATEtype Msg    = ToParse Stringupdate : Msg -&gt; Model -&gt; Modelupdate msg model =    case msg of        ToParse input -&gt;            case run hexToColor input of                Ok color -&gt;                    Just color                Err _ -&gt;                    model-- VIEWview : Model -&gt; Html Msgview model =    div []        [ input [ type_ &quot;text&quot;, placeholder &quot;Input hex color&quot;, onInput ToParse ] []        , div [] [ text (colorToString model) ]        ]hexToColor : Parser ColorhexToColor =    let        hexToInt : Parser Int        hexToInt =            Parser.map intFromHexString &lt;|                getChompedString &lt;|                    chompIf Char.isHexDigit                        |. chompIf Char.isHexDigit    in    succeed Color        |. symbol &quot;#&quot;        |= hexToInt        |= hexToInt        |= hexToInt        |. endintFromHexString : String -&gt; IntintFromHexString hex =    let        singleHex c =            if Char.isDigit c then                Char.toCode c - Char.toCode &#39;0&#39;            else                Char.toCode c - Char.toCode &#39;A&#39; + 10        power i =            List.product (List.repeat i 16)    in    String.toList (String.toUpper hex)        |&gt; List.indexedMap (\i item -&gt; power (String.length hex - i - 1) * singleHex item)        |&gt; List.sumcolorToString : Maybe Color -&gt; StringcolorToString color =    case color of        Nothing -&gt;            &quot;ä¸åˆæ³•çš„é¢œè‰²å€¼çš„è¾“å…¥ã€‚&quot;        Just p -&gt;            &quot;rgb(&quot; ++ String.fromInt p.red ++ &quot;,&quot; ++ String.fromInt p.green ++ &quot;,&quot; ++ String.fromInt p.blue ++ &quot;)&quot;</code></pre></details><!-- åˆ›å»ºæ—¥æœŸï¼š2020-03-27ï¼ŒåŠå¹´åæ¡èµ·æ¥å†™å®Œã€‚ä¸è¿‡ä¸€çœ‹å½“æ—¶å†™çš„è¿˜æ˜¯æŒºå¤šé”™çš„â€¦â€¦ -->]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªåŠ¨åŒ–ç¢ç¢å¿µæ ç›®</title>
      <link href="2020/08/13/tweets/minitweet/"/>
      <url>2020/08/13/tweets/minitweet/</url>
      
        <content type="html"><![CDATA[<p>çœ‹åˆ°äº†è¿™ä¸ªï¼š<a href="https://sspai.com/post/60024" target="_blank" rel="noopener">ä¿å«è¡¨è¾¾ï¼šç”¨åç«¯ BaaS å¿«é€Ÿæ­å»ºä¸“å±æ— ç‚¹èµè¯„è®ºç‰ˆå¾®åšâ€”â€”b è¨€ b è¯­</a> æ„Ÿè§‰æœ‰ç‚¹æ„æ€ã€‚</p><p><del>åˆå¯ä»¥æ„‰å¿«åœ°å¾€äº’è”ç½‘å€¾å€’ç¢ç¢å¿µäº†</del></p><p>å…¶å®ä¹Ÿå¯ä»¥å’Œé©¬ä¸Šè¦åšçš„ç¬”è®° app æ•´åˆèµ·æ¥â€¦â€¦ä¸è¿‡è¿˜æ˜¯æƒ³å®šæœŸç»Ÿè®¡æ•°æ®åšæˆé™æ€å¼çš„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¿— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ˜è…¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Endlesså¼€å‘ç¬”è®°ï¼ˆ2ï¼‰ï¼šä½¿ç”¨LiteDB</title>
      <link href="2020/07/13/endless-2/"/>
      <url>2020/07/13/endless-2/</url>
      
        <content type="html"><![CDATA[<p>èƒ½ç”¨å°±è¡Œ ğŸ‘¿</p><p>è¿™ç¯‡ä¸»è¦æ˜¯æ•°æ®ä¿å­˜ï¼Œä½¿ç”¨<a href="https://github.com/mbdavid/LiteDB" target="_blank" rel="noopener">LiteDB</a>ã€‚</p><a id="more"></a><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ol><li>åœ¨å·¥ç¨‹å‘½ä»¤è¡Œä¸‹ï¼š<code>Install-Package LiteDB</code>ï¼ˆæ²¡æˆåŠŸï¼‰æˆ–<code>dotnet add &lt;é¡¹ç›®åç§°&gt; package LiteDB --version 4.1.4</code>ï¼ˆç›®å‰<code>LiteDB.FSharp</code>ä¸æ”¯æŒ 5.0+çš„<code>LiteDB</code>ï¼‰æˆ–è€…ä¸‹è½½å¤åˆ¶ <code>dll</code>æ–‡ä»¶ã€‚</li><li>å®‰è£…<a href="https://github.com/Zaid-Ajaj/LiteDB.FSharp" target="_blank" rel="noopener">LiteDB.FSharp</a>:<code>dotnet add &lt;é¡¹ç›®åç§°&gt; package LiteDB.FSharp --version 2.15.1</code>ã€‚</li></ol><p>æ³¨ï¼š</p><p>ç”Ÿæˆæ—¶å‡ºç°äº†é”™è¯¯</p><blockquote><p>é”™è¯¯ XA2002: æ— æ³•è§£æå¼•ç”¨: <code>LiteDB</code>ï¼Œå¼•ç”¨è€…ä¸º <code>Endless</code>ã€‚è¯·ä¸º <code>LiteDB</code> æ·»åŠ  NuGet åŒ…æˆ–ç¨‹åºé›†å¼•ç”¨ï¼Œæˆ–åˆ é™¤å¯¹ <code>Endless</code> çš„å¼•ç”¨ã€‚</p></blockquote><p>å¯èƒ½æ˜¯å› ä¸ºæˆ‘ç”¨å®˜æ–¹ç»™çš„å®‰è£…æ–¹æ³•å¤±è´¥äº†ï¼Œæ‰€ä»¥åŒ…æ²¡è£…å®Œå…¨ã€‚</p><p>è§£å†³æ–¹æ³•ï¼šæ‰“å¼€<code>NugetåŒ…ç®¡ç†å™¨</code>ç»™ Android åŒ…é‡è£…ä¸€éåº“ã€‚</p><h2 id="ä¿å­˜è·¯å¾„"><a href="#ä¿å­˜è·¯å¾„" class="headerlink" title="ä¿å­˜è·¯å¾„"></a>ä¿å­˜è·¯å¾„</h2><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶æ¥å†™æ•°æ®åº“ç›¸å…³ã€‚</p><p>æ–‡ä»¶ä¿å­˜åœ¨ android çš„<a href="https://developer.android.google.cn/training/data-storage/app-specific" target="_blank" rel="noopener">åº”ç”¨ä¸“å±æ–‡ä»¶ç›®å½•</a>ä¸­ã€‚åˆ©ç”¨<a href="https://docs.microsoft.com/zh-cn/xamarin/xamarin-forms/app-fundamentals/dependency-service/" target="_blank" rel="noopener">dependency-service</a>å¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ç„¶ååˆ†å¹³å°å®ç°ã€‚(å‚ç…§äº†è¿™ä¸ªå®ç°åå¸çš„æ–¹æ³•ï¼š<a href="https://stackoverflow.com/questions/35279403/toast-equivalent-for-xamarin-forms" target="_blank" rel="noopener">Toast equivalent for Xamarin Forms</a>)</p><p>å®šä¹‰ï¼š</p><pre><code class="fsharp">type IDataBasePath =    abstract member Path:unit-&gt;string</code></pre><p>åœ¨ Android æ–‡ä»¶å¤¹ä¸‹ï¼š</p><pre><code class="fsharp">type DataBasePath()=    interface ELType.IDataBasePath with        member this.Path() = System.IO.Path.Combine(System.Environment.GetFolderPath(System.Environment.SpecialFolder.Personal), &quot;mydata.db&quot;)[&lt;assembly: Xamarin.Forms.Dependency(typeof&lt;DataBasePath&gt;)&gt;]do()</code></pre><p>æœ€åä½¿ç”¨çš„æ—¶å€™</p><pre><code class="f#">open LiteDBopen LiteDB.FSharpopen Xamarin.Formslet mapper = FSharpBsonMapper()let path = DependencyService.Get&lt;IDataBasePath&gt;().Path()let db = new LiteDatabase(path, mapper)</code></pre><h2 id="æ–‡æ¡£ç»“æ„"><a href="#æ–‡æ¡£ç»“æ„" class="headerlink" title="æ–‡æ¡£ç»“æ„"></a>æ–‡æ¡£ç»“æ„</h2><p><code>LiteDB.FSharp</code>åº“ä½¿ç”¨ records ç»„ç»‡ç»“æ„ã€‚è¿™é‡Œç›´æ¥ä½¿ç”¨ä¹‹å‰å®šä¹‰çš„<code>ELEntry</code>ä½œä¸ºå­˜å‚¨æ•°æ®ï¼š</p><p>åˆ©ç”¨ ID è‡ªå¢ã€‚</p><pre><code class="f#">[&lt;CLIMutable&gt;]type ELEntry= {    Id:int    Content:string    Date:string}</code></pre><p>ä¹‹åæ·»åŠ çš„æ¡ç›®,éœ€è¦è‡ªå¢çš„ id å¡« 0ã€‚</p><h3 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h3><pre><code class="fsharp">type ELEntry= {    Id:int    Content:string    Date:System.DateTime}type Model = {    NowId:int    NowWrite:string    Data:seq&lt;ELEntry&gt;}</code></pre><p>æ¶ˆæ¯æœ‰æ–°å»ºã€æ‰“å¼€ã€åˆ é™¤æ¶ˆæ¯æ¡†ã€åˆ é™¤ã€åé¦ˆè¾“å…¥çš„æ–‡å­—ã€ä¿å­˜å’Œåˆ‡æ¢ Tab ã€‚</p><pre><code class="fsharp">type Msg =    | NewEntry    | Open of int    | Delete of bool*int    | DeleteAlert of int    | NowWriting of string    | Save    | Switch of int</code></pre><h2 id="å¢åˆ æ”¹æŸ¥"><a href="#å¢åˆ æ”¹æŸ¥" class="headerlink" title="å¢åˆ æ”¹æŸ¥"></a>å¢åˆ æ”¹æŸ¥</h2><p>å…ˆå¾—åˆ°ä¸€ä¸ªè¡¨ã€‚</p><pre><code class="f#">let data = db.GetCollection&lt;ELEntry&gt;(&quot;entries&quot;)</code></pre><ol><li>å¢åŠ ï¼š<code>data.Insert(newEntry)</code></li><li>ä¿®æ”¹ï¼š<code>data.Upsert(newEntry)</code>ï¼ˆæ–°å¢æˆ–æ’å…¥ï¼‰ï¼Œ<code>data.Update(newEntry)</code>ã€‚</li><li>æŸ¥æ‰¾ï¼šè¿”å›çš„æ•°æ®ç±»å‹æ˜¯<code>seq&lt;ç±»å‹&gt;</code>ã€‚æ‰€ä»¥ Model ä¸­çš„ Data ä¸º<code>seq&lt;ELEntry&gt;</code>å‹ã€‚<ul><li>æŸ¥æ‰¾å…¨éƒ¨ï¼š <code>data.FindAll()</code></li><li>æŒ‰ id æŸ¥æ‰¾: <code>data.FindOne(fun data-&gt;data.Id=id)</code></li></ul></li><li>åˆ é™¤ï¼š<ul><li>æŒ‰ id åˆ é™¤ï¼š<code>data.Delete id</code></li></ul></li></ol><h3 id="ä¾‹"><a href="#ä¾‹" class="headerlink" title="ä¾‹"></a>ä¾‹</h3><ol><li><p>è¾“å…¥çš„æ—¶å€™ï¼Œæ•°æ®ä¿å­˜åˆ°<code>model.NowWrite</code>ä¸­ã€‚</p><p> å¯¹åº”<code>type Msg</code>çš„æ¶ˆæ¯ç±»å‹<code>NowWriting</code>ã€‚åœ¨è§†å›¾çš„ Editor ä¸­ï¼Œæ¯å½“è¾“å…¥æ–‡å­—æ—¶å‘é€æ¶ˆæ¯ã€‚</p><pre><code class="fsharp"> View.Editor     (text = model.NowWrite,     textChanged = (fun text -&gt; dispatch (NowWriting text.NewTextValue) |&gt; ignore),     &lt;ç•¥&gt;)</code></pre><p> å¤„ç†æ–¹æ³•ï¼š</p><pre><code class="fsharp"> match msg with | NowWriting str -&gt; { model with ELType.NowWrite = str }, Cmd.none | &lt;ç•¥&gt;</code></pre></li><li><p>ä¿å­˜çš„æ—¶å€™ï¼Œæ›´æ–°æ•°æ®åº“ã€‚</p><pre><code class="fsharp"> //è¾“å…¥ç•Œé¢ View.NavigationPage     (icon = penImg, title = &quot;ç¬”è®°&quot;, toolbarItems = [ View.ToolbarItem(icon = saveImg, command = (fun()-&gt; dispatch Save) ) ], &lt;ç•¥&gt;) //update match msg with     | Save -&gt;         let newEntry =             { Content = model.NowWrite             Date = System.DateTime.Today             Id = model.NowId }         ELDb.upsert (newEntry) |&gt; ignore         { model with             NowWrite = &quot;&quot;             Data = ELDb.data.FindAll() },         Cmd.none</code></pre></li></ol><h2 id="æœ€åçš„æ•ˆæœ"><a href="#æœ€åçš„æ•ˆæœ" class="headerlink" title="æœ€åçš„æ•ˆæœ"></a>æœ€åçš„æ•ˆæœ</h2><p><img src="/2020/07/13/endless-2/endless-21.jpg" alt="ç»“æœ"></p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><ul><li><p>å®é™…å†™çš„æ—¶å€™å‘ç°è®¾è®¡æ²¡åšå¥½ï¼Œè¿˜éœ€è¦ä¸€ä¸ªâ€œæ–°å»ºâ€æŒ‰é’®å’Œâ€œåˆ é™¤â€æŒ‰é’®ã€‚æ–°å»ºçš„æ—¶å€™å°† ID ç½® 0ã€‚ï¼ˆåˆå›å»æ”¹ç¬¬ä¸€ç¯‡åšæ–‡ ğŸ˜“ï¼‰</p></li><li><p>å¼‚å¸¸å¤„ç†æ²¡åš</p></li><li><p>æ‰“åŒ…å‡ºæ¥ 20Mï¼Œä¸‹æ¬¡å†™ flutterã€‚</p></li></ul><p><strong>å‚è€ƒï¼š</strong></p><ul><li><a href="https://www.litedb.org/docs/" target="_blank" rel="noopener">LiteDB æ–‡æ¡£å‚è€ƒ</a></li><li><a href="https://docs.microsoft.com/zh-cn/xamarin/android/platform/files/#reading-or-writing-to-files-on-internal-storage" target="_blank" rel="noopener">å†…éƒ¨å­˜å‚¨ä¸Šçš„æ–‡ä»¶è¯»å†™ - Xamarin</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Fabulous </tag>
            
            <tag> F# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Endlesså¼€å‘ç¬”è®°ï¼ˆ1ï¼‰ï¼šåŸºç¡€å¸ƒå±€</title>
      <link href="2020/06/20/endless-1/"/>
      <url>2020/06/20/endless-1/</url>
      
        <content type="html"><![CDATA[<p>æ–°çš„ä¸€å¤©æ–°çš„ Flagï¼Œçªç„¶æƒ³æ•´ F#ï¼Œåšä¸æ¥å°±å›é€€ã€‚</p><a id="more"></a><h2 id="è½¯ä»¶åŸå‹"><a href="#è½¯ä»¶åŸå‹" class="headerlink" title="è½¯ä»¶åŸå‹"></a>è½¯ä»¶åŸå‹</h2><p>ä¸€ä¸ªå¿«é€Ÿç¬”è®°è½¯ä»¶ã€‚ç‚¹å‡»è¿›è½¯ä»¶å°±æ˜¯å†™ä½œç•Œé¢ï¼Œå…³é—­è½¯ä»¶æˆ–æŒ‰ä¸‹ä¿å­˜é”®åˆ™å½’æ¡£è¿›å…¥ä¿å­˜å¡ç‰‡ã€‚</p><p>åŸå‹å›¾ï¼š</p><p><img src="/2020/06/20/endless-1/endless.png" alt="åŸå‹å›¾"></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ol><li>è£… vs</li><li>æŒ‰ç…§<a href="https://fsprojects.github.io/Fabulous/Fabulous.XamarinForms/" target="_blank" rel="noopener">å®˜ç½‘çš„æ–¹æ³•</a>ï¼Œæ‰“å¼€ vs å‘½ä»¤è¡Œ,è¾“å…¥ <code>dotnet new -i Fabulous.XamarinForms.Templates</code></li><li>cd è¿›æƒ³è¦åˆ›å»ºå·¥ç¨‹çš„æ–‡ä»¶å¤¹ï¼Œè¾“å…¥ <code>dotnet new fabulous-xf-app -n &lt;å·¥ç¨‹åå­—&gt;</code> ã€‚é»˜è®¤åˆ›å»º android å’Œ ios ç¨‹åºï¼Œä¸æƒ³è¦/æ·»åŠ æ–°çš„éœ€è¦åŠ å‚æ•°ã€‚ä¾‹ï¼šåˆ›å»º wpf ç¨‹åº<code>dotnet new fabulous-xf-app -n &lt;å·¥ç¨‹åå­—&gt; --iOS=false --Android=false --WPF</code></li></ol><p>è¿™æ¬¡è½¯ä»¶åè®¾ä¸º Endless,æœ‰ Android ç«¯ã€‚åˆ™åˆå§‹åŒ–å‘½ä»¤ä¸º<code>dotnet new fabulous-xf-app -n Endless --iOS=false</code></p><h2 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h2><h3 id="ä½¿ç”¨å­—ä½“å›¾æ ‡"><a href="#ä½¿ç”¨å­—ä½“å›¾æ ‡" class="headerlink" title="ä½¿ç”¨å­—ä½“å›¾æ ‡"></a>ä½¿ç”¨å­—ä½“å›¾æ ‡</h3><ol><li><p>å­—ä½“æ”¾å…¥å…±ç”¨å·¥ç¨‹å†…ï¼ˆå’Œå·¥ç¨‹åç›¸åŒï¼Œæ­¤å¤„ä¸º Endlessï¼‰ï¼Œç„¶ååœ¨å­—ä½“çš„å±æ€§æ ä¸­ï¼Œå°†ç”Ÿæˆæ“ä½œè®¾ç½®ä¸º<code>åµŒå…¥çš„èµ„æº</code>ï¼ˆBuild Action: <code>EmbeddedResource</code>ï¼‰ã€‚</p></li><li><p>åœ¨å…±ç”¨å·¥ç¨‹ä¸‹ï¼Œå»ºç«‹<code>AssemblyInfo.fs</code>ï¼ˆæˆ–è€…åœ¨åˆ«çš„æ–‡ä»¶é‡Œï¼‰ï¼Œæ³¨å†Œèµ„æºï¼š</p><pre><code class="fsharp"> namespace Endless open Xamarin.Forms [&lt;assembly:ExportFont(&quot;MaterialIcons-Regular.ttf&quot;, Alias = &quot;MaterialIcons&quot;)&gt;] do ()</code></pre></li><li><p>å¼•ç”¨å­—ä½“çš„æ—¶å€™ç›´æ¥å†™ã€‚ä¾‹ï¼šä»å­—ä½“å›¾æ ‡ä¸­æ‰¾åˆ°â€œç¬”â€å¹¶å°†å…¶ä½œä¸ºå›¾ç‰‡ã€‚<code>Glyph</code>æ˜¯å›¾æ ‡çš„ unicode ç ã€‚</p><pre><code class="fsharp"> let penImg = Image.ImageFont(FontImageSource(Glyph=&quot;\ue254&quot;,FontFamily=&quot;MaterialIcons&quot;))</code></pre><p> ç„¶å</p><pre><code class="fsharp"> View.TabbedPage(children=[         View.ContentPage(icon =penImg, title=&quot;ç¬”è®°&quot;)         View.ContentPage(icon=archiveImg, title=&quot;å½’æ¡£&quot;)])</code></pre></li></ol><h3 id="æ ‡é¢˜æ "><a href="#æ ‡é¢˜æ " class="headerlink" title="æ ‡é¢˜æ "></a>æ ‡é¢˜æ </h3><p>ä¸ºäº†æ˜¾ç¤ºæ ‡é¢˜æ ï¼Œç»™æ¯ä¸ªé¡µé¢å¥—äº†ä¸ª<code>NavigationPage</code>ã€‚</p><p>æ ‡é¢˜æ ä¸Šçš„æ¯ä¸ªç‰©ä»¶å±äº<code>ToolbarItem</code>ï¼Œå¯ä»¥é™„ç€åœ¨<code>Page</code>å‹çš„<code>toolbaritems</code>ä¸‹ã€‚</p><p><code>ToolbarItem</code>å¯å®šä¹‰çš„æœ‰:</p><ul><li><code>Command</code> ç»‘å®šç”¨æˆ·åŠ¨ä½œ</li><li><code>CommandParameter</code> ä¼ é€ç»™æ§ä»¶çš„å˜é‡</li><li><code>Icon</code> å›¾æ ‡</li><li><code>Text</code> æ˜¾ç¤ºçš„æ–‡å­—</li><li><code>Order</code> æšä¸¾å‚æ•°ï¼Œå†³å®šç‰©å“æ˜¾ç¤ºåœ¨ä¸€çº§èœå•è¿˜æ˜¯äºŒçº§èœå•ä¸­</li><li><code>Priority</code> æ˜¾ç¤ºé¡ºåº</li></ul><p>ä¾‹ï¼š</p><pre><code class="fsharp">  let writePage = View.NavigationPage            (icon = penImg, title = &quot;ç¬”è®°&quot;,             toolbarItems=[View.ToolbarItem(icon=saveImg)],  //saveImgä¹Ÿæ˜¯ä¸€ä¸ªå›¾ç‰‡             pages = &lt;ç•¥&gt;)  let archivePage = &lt;ç•¥&gt;</code></pre><p>è€ŒåŸ<code>TabbedPage</code>å˜æˆï¼š</p><pre><code class="fsharp">View.TabbedPage(children = [ writePage; archivePage ])</code></pre><h3 id="è¾“å…¥æ¡†"><a href="#è¾“å…¥æ¡†" class="headerlink" title="è¾“å…¥æ¡†"></a>è¾“å…¥æ¡†</h3><p>è‡ªåŠ¨æ”¹å˜å¤§å°</p><pre><code class="fsharp">View.Editor(placeholder = &quot;ç­‰å¾…è¾“å…¥&quot;, autoSize = EditorAutoSizeOption.TextChanges)</code></pre><h3 id="å½’æ¡£é¡µé¢"><a href="#å½’æ¡£é¡µé¢" class="headerlink" title="å½’æ¡£é¡µé¢"></a>å½’æ¡£é¡µé¢</h3><p>å¡ç‰‡å¸ƒå±€ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«è¦å†™çš„ã€‚å®ç°ä¸»è¦æ˜¯<code>FlexLayout</code> + <code>StackLayout</code>å’Œä¸€ä¸ª<code>Frame</code>.</p><p><code>Frame</code>ä¸è®¾ç½®è¾¹æ¡†å±æ€§çš„è¯ä¸æ˜¾ç¤ºé˜´å½±ï¼Œæœ‰ç‚¹å¥‡æ€ªã€‚</p><ul><li><a href="https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/layouts/flex-layout#the-bindable-properties-in-detail" target="_blank" rel="noopener">FlexLayout å¸ƒå±€å±æ€§å‚è€ƒ</a></li></ul><h2 id="äº¤äº’"><a href="#äº¤äº’" class="headerlink" title="äº¤äº’"></a>äº¤äº’</h2><h3 id="1-ç‚¹å‡»å¡ç‰‡"><a href="#1-ç‚¹å‡»å¡ç‰‡" class="headerlink" title="1. ç‚¹å‡»å¡ç‰‡"></a>1. ç‚¹å‡»å¡ç‰‡</h3><p>å¡ç‰‡å†…å®¹æ˜¾ç¤ºåœ¨è¾“å…¥ç•Œé¢é‡Œã€‚</p><p>è¿™é‡Œç”¨çš„æ˜¯å‡æ•°æ®ï¼Œåé¢å†è¿æ•°æ®åº“ã€‚</p><ul><li><a href="https://fsprojects.github.io/Fabulous/Fabulous.XamarinForms/views-gestures.html" target="_blank" rel="noopener">æ‰‹åŠ¿å‚è€ƒ</a></li></ul><pre><code class="fsharp">//åœ¨å¡ç‰‡é‡Œè®¾ç½®ç‚¹å‡»ååº”gestureRecognizers = ([ View.TapGestureRecognizer(command = (fun () -&gt; dispatch (Open entry.Id))) ]),...//update| Open id -&gt; let e=(search id model.Data) in {model with  NowWrite= e.Content; NowId = e.Id},Cmd.none</code></pre><h3 id="2-ä½¿ç”¨ä»£ç åˆ‡æ¢-Tab"><a href="#2-ä½¿ç”¨ä»£ç åˆ‡æ¢-Tab" class="headerlink" title="2. ä½¿ç”¨ä»£ç åˆ‡æ¢ Tab"></a>2. ä½¿ç”¨ä»£ç åˆ‡æ¢ Tab</h3><p>ä¸Šæ–‡ä¸­â€œç‚¹å‡»å¡ç‰‡è¿”å›è¾“å…¥ç•Œé¢â€çš„å®ç°ã€‚è§‚å¯Ÿå‘ç°<code>TabbedPage</code>æœ‰å±æ€§<code>currentPage</code>å¯ä»¥<code>get,set</code>ã€‚æ‰€ä»¥å°è¯•é€šè¿‡æ”¹å˜<code>currentPage</code>æ¥æ”¹å˜å½“å‰é¡µé¢çš„å€¼ã€‚</p><p>å¼•ç”¨<code>TabbedPage</code>ä½¿ç”¨äº†<a href="https://fsprojects.github.io/Fabulous/Fabulous.XamarinForms/views-animations.html#viewrefs" target="_blank" rel="noopener">ViewRef</a>ã€‚<code>ViewRef</code>æ˜¯å¼±å¼•ç”¨ï¼Œåˆå§‹ä¸ºç©ºï¼Œ_åœ¨<code>view</code>å‡½æ•°è¢«è°ƒç”¨å¹¶æ˜¾ç¤ºåæ‰å¡«å……å€¼_ï¼Œæ‰€ä»¥å°†å¯¹<code>ViewRef</code>çš„å¤„ç†æ”¾åˆ°äº†<code>update</code>å‡½æ•°ä¸­ã€‚</p><pre><code class="fsharp">//å£°æ˜let tabRef = ViewRef&lt;TabbedPage&gt;()...//è®¾ç½®View.TabbedPage        (ref = tabRef, children = [ writePage; archivePage ])</code></pre><p>ä¿®æ”¹ä¸Šæ–‡ç‚¹å‡»ååº”ï¼Œå‘é€åˆ‡æ¢é¡µé¢çš„æ¶ˆæ¯ã€‚</p><pre><code class="fsharp">gestureRecognizers =    ([ View.TapGestureRecognizer        (command =            (fun () -&gt;                dispatch (Open entry.Id)                dispatch (Switch 0))) ])</code></pre><p>update ä¸­å¤„ç†é¡µé¢åˆ‡æ¢ã€‚</p><pre><code class="fsharp">    let update (msg: Msg) (model: Model) =        match msg with        | Switch index -&gt;            match tabRef.TryValue with            | None -&gt; ()            | Some page -&gt; page.CurrentPage &lt;- page.GetPageByIndex(index)            model, Cmd.none        |  &lt;ç•¥&gt;</code></pre><h3 id="3-æå–è¾“å…¥çš„æ ‡é¢˜"><a href="#3-æå–è¾“å…¥çš„æ ‡é¢˜" class="headerlink" title="3. æå–è¾“å…¥çš„æ ‡é¢˜"></a>3. æå–è¾“å…¥çš„æ ‡é¢˜</h3><p>è®¾è®¡ï¼šè¾“å…¥ç¬”è®°çš„ç¬¬ä¸€è¡Œå¦‚æœæ˜¯<code># æ ‡é¢˜</code>ï¼Œé‚£ä¹ˆå°†ç¬¬ä¸€è¡Œè®¾ç½®ä¸ºæ ‡é¢˜ã€‚ //éå¸¸ç®€é™‹</p><pre><code class="fsharp">let cardParser (str:string) =    let res = Regex(&quot;#(.*)&quot;).Match(str)    if res.Success then (res.Value.[1..].Trim(), str.[res.Length..].Trim())    else (&quot;&quot;,str)</code></pre><h3 id="4-å¼¹çª—"><a href="#4-å¼¹çª—" class="headerlink" title="4. å¼¹çª—"></a>4. å¼¹çª—</h3><p>å¼¹çª—ï¼š<a href="https://fsprojects.github.io/Fabulous/Fabulous.XamarinForms/views-popups.html" target="_blank" rel="noopener">Pop-ups</a></p><p>æ ¹æ®æ–‡æ¡£é‡Œçš„è¯´æ³•ï¼Œ</p><blockquote><p><code>Pop-ups</code>æ˜¯<code>Fabulous for Xamarin.Forms</code>ä¸­çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼šä»–ä»¬æ˜¯è§†å›¾çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸å’Œ UI çš„å…¶ä»–éƒ¨åˆ†å…±äº«ç”Ÿå‘½å‘¨æœŸã€‚åœ¨<code>Xamarin.Forms</code>ä¸­ï¼Œ<code>Pop-ups</code>ç”¨å½“å‰é¡µé¢çš„ä¸¤ç§æ–¹æ³•æš´éœ²ï¼š<code>DisplayAlert</code> å’Œ <code>DisplayActionSheet</code>ã€‚<br>åœ¨<code>Fabulous for Xamarin.Forms</code>ä¸­æˆ‘ä»¬ä»…æè¿°é¡µé¢è¯¥æ˜¯ä»€ä¹ˆæ ·ï¼Œå¹¶ä¸è®¿é—® UI æ§ä»¶æœ¬èº«ï¼Œæ‰€ä»¥æ²¡æœ‰ç›´æ¥çš„æ–¹æ³•ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>Xamarin.Forms</code>æš´éœ²çš„é™æ€å±æ€§ <code>Application.Current.MainPage</code> ã€‚</p></blockquote><p>æ‰€ä»¥,ç‚¹å‡»åˆ é™¤æ—¶ <del>ï¼ˆå…¶å®åœ¨åŸå‹å›¾é‡Œå¿˜ç”»äº†ï¼‰</del></p><pre><code class="fsharp">| DeleteAlert id -&gt;            let alertResult =                async {                    let! alert =                        Application.Current.MainPage.DisplayAlert(&quot;è­¦å‘Š&quot;, &quot;åˆ é™¤è¿™æ¡ä¿¡æ¯ï¼Ÿ&quot;, &quot;æ˜¯&quot;, &quot;å¦&quot;)                        |&gt; Async.AwaitTask                    return Delete (alert,id)                }            model, Cmd.ofAsyncMsg alertResult| Delete (alert,id) -&gt; &lt;åç»­å¤„ç†&gt;</code></pre>]]></content>
      
      
      <categories>
          
          <category> Android </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Fabulous </tag>
            
            <tag> F# </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS ç¬”è®°ï¼šPromise</title>
      <link href="2020/05/17/js-promise/"/>
      <url>2020/05/17/js-promise/</url>
      
        <content type="html"><![CDATA[<blockquote><p>Promise å¯¹è±¡ç”¨äºè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆ (æˆ–å¤±è´¥), åŠå…¶ç»“æœå€¼.</p></blockquote><a id="more"></a><h2 id="æ„é€ ä¸€ä¸ª-Promise"><a href="#æ„é€ ä¸€ä¸ª-Promise" class="headerlink" title="æ„é€ ä¸€ä¸ª Promise"></a>æ„é€ ä¸€ä¸ª Promise</h2><pre><code class="js">let p = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;1ç§’åæ‰§è¡Œä»£ç &quot;), 1000);});p.then((data) =&gt; console.log(data));//1ç§’åæ‰§è¡Œä»£ç </code></pre><p><code>Promise</code>æœ‰ä¸‰ç§çŠ¶æ€ï¼š</p><ul><li>åˆå§‹çŠ¶æ€ <code>pending</code></li><li>æˆåŠŸ <code>fulfilled</code></li><li>å¤±è´¥ <code>rejected</code>ã€‚</li></ul><p>ä¸€ä¸ªå®Œæˆå‰çš„æ§åˆ¶å°æ‰“å°ï¼š</p><pre><code class="js">let p = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;1ç§’åæ‰§è¡Œä»£ç &quot;), 1000);});console.log(p);//Promise { &lt;state&gt;: &quot;pending&quot; }p.then((data) =&gt; console.log(p));//Promise { &lt;state&gt;: &quot;fulfilled&quot;, &lt;value&gt;: &quot;1ç§’åæ‰§è¡Œä»£ç &quot; }</code></pre><h2 id="ä½¿ç”¨ä¸€ä¸ª-Promise"><a href="#ä½¿ç”¨ä¸€ä¸ª-Promise" class="headerlink" title="ä½¿ç”¨ä¸€ä¸ª Promise"></a>ä½¿ç”¨ä¸€ä¸ª Promise</h2><ul><li>å›è°ƒå‡½æ•°åœ¨æœ¬è½®æ‰€æœ‰äº‹ä»¶å¾ªç¯è¿è¡Œå®Œæˆåæ‰§è¡Œã€‚</li><li>ä½¿ç”¨ <code>catch</code> ç»ˆæ­¢é“¾ä»¥æ•è·å¼‚å¸¸ã€‚</li><li>ä½¿ç”¨ <code>finally</code> å®Œæˆæ— è®ºæˆåŠŸä¸å¦çš„åç»­æ“ä½œã€‚</li></ul><pre><code class="js">let p1 = new Promise((resolve, reject) =&gt; {  reject(&quot;fail&quot;);});p1.then((data) =&gt; console.log(data))  .catch((e) =&gt; console.log(e))  .finally(() =&gt; {    console.log(&quot;finally&quot;);  });//fail//finally</code></pre><h2 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h2><p><code>Promise.all</code></p><p>æ–¹æ³•è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œæ‰€æœ‰å‚æ•°é‡Œçš„<code>promise</code>éƒ½è§¦å‘æˆåŠŸçš„æ—¶å€™æ‰ä¼šæˆåŠŸï¼Œå¹¶å°†å‚æ•°é‡Œæ‰€æœ‰<code>promise</code>çš„è¿”å›å€¼æ•°ç»„ä½œä¸ºæˆåŠŸå›è°ƒçš„è¿”å›å€¼ï¼Œç¬¬ä¸€ä¸ªå¤±è´¥çš„<code>promise</code>ä¿¡æ¯ä½œä¸ºå¤±è´¥ä¿¡æ¯ã€‚</p><p><code>Promise.race</code></p><p>ä»»æ„ä¸€ä¸ªå‚æ•°ä¸­çš„å­<code>promise</code>è¿”å›ç»“æœåï¼Œå°†å…¶ç»“æœè¿”å›ã€‚</p><pre><code class="js">let p1 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;1ç§’&quot;), 1000);});let p2 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;2ç§’&quot;), 2000);});let p3 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;3ç§’&quot;), 2000);});Promise.race([p1, p2, p3]).then((data) =&gt; console.log(data));//1ç§’Promise.all([p1, p2, p3]).then((data) =&gt; console.log(data));//[&quot;1ç§’&quot;, &quot;2ç§’&quot;, &quot;3ç§’&quot;]</code></pre><p>å®ç°ä¸€ä¸ª<code>Promise.all</code></p><pre><code class="js">function myPromiseAll(parr) {  let ans = [];  return new Promise((resolve, reject) =&gt; {    run(0);    function run(i) {      if (i &lt; parr.length)        return parr[i]          .then((data) =&gt; {            ans.push(data);            run(i + 1);          })          .catch((e) =&gt; reject(e));      else resolve(ans);    }  });}/*æµ‹è¯•*/let p1 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;1ç§’&quot;), 1000);});let p2 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;2ç§’&quot;), 2000);});let p3 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;3ç§’&quot;), 3000);});let p4 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; reject(&quot;é”™è¯¯&quot;), 1000);});myPromiseAll([p1, p2, p3]).then((data) =&gt; console.log(data));//[&quot;1ç§’&quot;, &quot;2ç§’&quot;, &quot;3ç§’&quot;]myPromiseAll([p1, p2, p4])  .then((data) =&gt; console.log(data))  .catch((e) =&gt; console.log(e));//é”™è¯¯</code></pre><p>å®ç°ä¸€ä¸ª<code>Promise.race</code></p><pre><code class="js">function myPromiseRace(parr) {  return new Promise((resolve, reject) =&gt; {    for (let p of parr) p.then((data) =&gt; resolve(data)).catch((e) =&gt; reject(e));  });}/*æµ‹è¯•*/let p1 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;1ç§’&quot;), 1000);});let p2 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;2ç§’&quot;), 2000);});let p3 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; resolve(&quot;3ç§’&quot;), 3000);});let p4 = new Promise((resolve, reject) =&gt; {  setTimeout(() =&gt; reject(&quot;é”™è¯¯&quot;), 1000);});myPromiseRace([p3, p2, p1]).then((d) =&gt; console.log(d));//1ç§’myPromiseRace([p2, p3, p4])  .then((d) =&gt; console.log(d))  .catch((e) =&gt; console.log(e));//é”™è¯¯</code></pre><p>å‚è€ƒï¼š</p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank" rel="noopener">Promise - MDN</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Using_promises" target="_blank" rel="noopener">ä½¿ç”¨ Promise - MDN</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS ç¬”è®°ï¼šSymbol &amp; åˆ¤æ–­æ•°æ®ç±»å‹</title>
      <link href="2020/05/17/js-symbol/"/>
      <url>2020/05/17/js-symbol/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><code>Symbol</code>æ˜¯ä¸€ç§åŸºæœ¬æ•°æ®ç±»å‹ã€‚<code>Symbol()</code>ä¼šè¿”å›ä¸€ä¸ªå”¯ä¸€çš„å€¼ã€‚<strong>ä¸æ˜¯<code>new Symbol()</code></strong>ã€‚</p><a id="more"></a><pre><code class="js">let s1 = Symbol();let s2 = Symbol(&quot;a&quot;);let s3 = Symbol(&quot;a&quot;);console.log(s1 == s2); //falseconsole.log(s2 == s3); //falseconsole.log(s1); //[object Symbol]</code></pre><h2 id="åˆ¤æ–­æ•°æ®ç±»å‹"><a href="#åˆ¤æ–­æ•°æ®ç±»å‹" class="headerlink" title="åˆ¤æ–­æ•°æ®ç±»å‹"></a>åˆ¤æ–­æ•°æ®ç±»å‹</h2><p>javascript çš„æ•°æ®ç±»å‹æœ‰å¦‚ä¸‹å‡ ç§:</p><p>åŸºæœ¬ç±»å‹ï¼š</p><ul><li><code>Number</code></li><li><code>String</code></li><li><code>Boolean</code></li><li><code>Null</code></li><li><code>Undefined</code></li><li><code>Symbol</code></li></ul><p>å¼•ç”¨ç±»å‹ï¼š</p><ul><li><code>object</code>ï¼šå…¶ä¸­åˆæœ‰ <code>function</code>,<code>Array</code>ï¼Œ<code>Date</code>ï¼Œ<code>Map</code> <code>Set</code> <code>WeakMap</code> <code>WeakSet</code> <code>json</code>ç­‰</li></ul><h3 id="ä½¿ç”¨-typeof-åˆ¤æ–­æ•°æ®ç±»å‹ï¼š"><a href="#ä½¿ç”¨-typeof-åˆ¤æ–­æ•°æ®ç±»å‹ï¼š" class="headerlink" title="ä½¿ç”¨ typeof åˆ¤æ–­æ•°æ®ç±»å‹ï¼š"></a>ä½¿ç”¨ <code>typeof</code> åˆ¤æ–­æ•°æ®ç±»å‹ï¼š</h3><pre><code class="js">function printType(ele) {  console.log(typeof ele);}let group = {  &quot;1&quot;: 1,  str: &quot;str&quot;,  true: true,  null: null,  undefined: undefined,  symbol: Symbol(),  &quot;[1,2,3]&quot;: [1, 2, 3],  Date: new Date(),  json: { a: &quot;aaa&quot; },};for (i in group) {  console.log(i + &quot; &quot; + typeof group[i]);}function f() {  return true;}console.log(&quot;function &quot; + typeof f);// 1 number// str string// true boolean// null object// undefined undefined// symbol symbol// [1,2,3] object// Date object// json object// function function </code></pre><p>å¥‡å¼‚çš„æ˜¯ <code>null</code> ä¼šè¢«åˆ¤æ–­æˆ <code>object</code>ã€‚ç»æŸ¥æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/typeof" target="_blank" rel="noopener">å†å²æ€§ bug</a>ã€‚</p><h3 id="ä½¿ç”¨-instanceof-åˆ¤æ–­æ•°æ®ç±»å‹"><a href="#ä½¿ç”¨-instanceof-åˆ¤æ–­æ•°æ®ç±»å‹" class="headerlink" title="ä½¿ç”¨ instanceof åˆ¤æ–­æ•°æ®ç±»å‹"></a>ä½¿ç”¨ <code>instanceof</code> åˆ¤æ–­æ•°æ®ç±»å‹</h3><pre><code class="js">function f() {  return true;}console.log(new Date() instanceof Date); //trueconsole.log([1, 2, 3] instanceof Array); //trueconsole.log([1, 2, 3] instanceof Function); //falseconsole.log(f instanceof Function); //true</code></pre>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSSï¼šç›’æ¨¡å‹</title>
      <link href="2020/05/13/css-box/"/>
      <url>2020/05/13/css-box/</url>
      
        <content type="html"><![CDATA[<p><code>ç›’æ¨¡å‹</code>(Box Model)æ˜¯ CSS å¸ƒå±€çš„ä¸€ç§æ¨¡å¼ã€‚</p><a id="more"></a><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>ä¸€ä¸ªç›’æ¨¡å‹å…ƒç´ ä»å†…åˆ°å¤–åˆ†ä¸ºï¼š</p><ul><li>Content å†…å®¹</li><li>Padding å†…è¾¹è·</li><li>Border è¾¹æ¡†</li><li>Margin å¤–è¾¹æ¡†</li></ul><p>æŒ‡å®šç›’æ¨¡å‹ï¼š</p><pre><code class="css">box-sizing: content-box //å®½åº¦å’Œé«˜åº¦åº”ç”¨åˆ°contentbox-sizing: border-box   //IEå‹ï¼Œå®½åº¦å’Œé«˜åº¦åº”ç”¨åˆ°Borderä¸ºæ­¢</code></pre><h2 id="å…ƒç´ å±…ä¸­"><a href="#å…ƒç´ å±…ä¸­" class="headerlink" title="å…ƒç´ å±…ä¸­"></a>å…ƒç´ å±…ä¸­</h2><h3 id="æ°´å¹³å±…ä¸­"><a href="#æ°´å¹³å±…ä¸­" class="headerlink" title="æ°´å¹³å±…ä¸­"></a>æ°´å¹³å±…ä¸­</h3><ul><li>æ–‡å­—ï¼šè®¾ç½® <code>text-align:center</code>ã€‚</li><li>å—çº§å…ƒç´ ï¼šè®¾ç½® <code>margin:0 auto</code>ï¼Œå¿…é¡»è‡ªèº«æœ‰å®½åº¦ã€‚</li></ul><h3 id="å‚ç›´å±…ä¸­"><a href="#å‚ç›´å±…ä¸­" class="headerlink" title="å‚ç›´å±…ä¸­"></a>å‚ç›´å±…ä¸­</h3><ul><li>å•è¡Œæ–‡å­—ï¼šè®¾ç½® <code>line-height:&lt;çˆ¶é«˜åº¦&gt;</code>ã€‚</li><li>å—çº§å…ƒç´ ï¼š<code>position:relative;top:25%;</code>ï¼Œå¿…é¡»è‡ªèº«æœ‰é«˜åº¦ã€‚</li><li>å—çº§å…ƒç´ ï¼š <code>position:relative; top:50%; left:50%; transform: translate(-50%,-50%);</code>ï¼Œè‡ªèº«å¯ä¸è®¾é«˜åº¦ã€‚</li></ul><h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><ul><li>è®¾ç½®çˆ¶å…ƒç´ ä¸º<code>display:flex;align-items: center;justify-content: center;</code>ã€‚<code>align-items</code>ç®¡ä¸Šä¸‹ï¼Œ<code>justify-content</code>ç®¡å·¦å³ã€‚</li><li>è®¾ç½®çˆ¶å…ƒç´ ä¸º<code>grid</code>ï¼ŒåŒä¸Šã€‚</li></ul><h2 id="å±æ€§é€‰æ‹©å™¨çš„åŒ¹é…"><a href="#å±æ€§é€‰æ‹©å™¨çš„åŒ¹é…" class="headerlink" title="å±æ€§é€‰æ‹©å™¨çš„åŒ¹é…"></a>å±æ€§é€‰æ‹©å™¨çš„åŒ¹é…</h2><pre><code class="css">[class^=&quot;parent&quot;]//é€‰æ‹©ä»¥parentå¼€å¤´çš„ç±»[attribute^=&quot;value&quot;]//é€‰å±æ€§å€¼ä»¥valueå¼€å¤´çš„å…ƒç´ [attribute=value]//é€‰æ‹©å±æ€§å€¼=valueçš„å…ƒç´ [attribute~=value]//é€‰æ‹©å±æ€§å€¼åŒ…å«valueçš„å…ƒç´ </code></pre><p>å‚è€ƒï¼š<a href="https://www.w3school.com.cn/cssref/css_selectors.asp" target="_blank" rel="noopener">CSS é€‰æ‹©å™¨</a></p>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å®‰å…¨ï¼ˆXSS &amp; CSRFï¼‰</title>
      <link href="2020/04/29/fe-security/"/>
      <url>2020/04/29/fe-security/</url>
      
        <content type="html"><![CDATA[<p>éšä¾¿äº†ã€‚</p><a id="more"></a><h2 id="XSS-æ”»å‡»"><a href="#XSS-æ”»å‡»" class="headerlink" title="XSS æ”»å‡»"></a>XSS æ”»å‡»</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>XSSï¼ˆCross Site Scriptingï¼Œè·¨ç«™è„šæœ¬ï¼‰æ”»å‡»ã€‚åœ¨é¡µé¢ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œåœ¨è¿è¡Œæ—¶æ”»å‡»ã€‚</p><p>ä¸»è¦åˆ†ä¸ºåå°„å‹ï¼ˆä¿®æ”¹ URLï¼‰ï¼Œå­˜å‚¨å‹ï¼ˆä¸Šä¼ åˆ°æ•°æ®åº“ï¼Œä»æ•°æ®åº“ä¸­æå–è¿”å›æ—¶è¿è¡Œï¼‰ã€‚é‡ç‚¹åœ¨äºå¤„ç†ç”¨æˆ·è¾“å…¥ã€‚</p><h3 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h3><ul><li>X-XSS-Protection</li></ul><p>HTTP å“åº”å¤´ä¸­çš„ <code>X-XSS-Protection</code>å±æ€§(<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-XSS-Protection" target="_blank" rel="noopener">MDN</a>ï¼Œ<strong>éè§„èŒƒ</strong>)ã€‚å½“æ£€æµ‹åˆ° XSS æ”»å‡»æ—¶ï¼Œæµè§ˆå™¨åœæ­¢åŠ è½½é¡µé¢ã€‚</p><p>è¯­æ³•ï¼š</p><pre><code class="http">X-XSS-Protection: 0 //ç¦æ­¢xssè¿‡æ»¤X-XSS-Protection: 1  //å¼€å¯ï¼ˆé»˜è®¤ï¼‰X-XSS-Protection: 1; mode=block //æ£€æµ‹åˆ°æ”»å‡»ï¼Œé˜»æ­¢åŠ è½½</code></pre><ul><li>Content-Security-Policy</li></ul><p>HTTP å“åº”å¤´ä¸­çš„ <code>Content-Security-Policy</code>å±æ€§ï¼ˆ<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Security-Policy" target="_blank" rel="noopener">MDN</a>ï¼‰ã€‚æ§åˆ¶é¡µé¢èƒ½åŠ è½½å“ªäº›èµ„æºã€‚</p><p>è¯­æ³•ï¼š</p><pre><code class="http">//åœ¨ http header ä¸Šä½¿ç”¨Content-Security-Policy: &lt;ç­–ç•¥&gt;; &lt;ç­–ç•¥&gt;//åœ¨ html ä¸Šä½¿ç”¨&lt;meta http-equiv=&quot;content-security-policy&quot; content=&quot;&lt;ç­–ç•¥&gt;; &lt;ç­–ç•¥&gt;&quot;&gt;</code></pre><p>ä¸¾ä¾‹ï¼š</p><p>æ‰€æœ‰èµ„æºå‡æ¥è‡ªå½“å‰åŸŸåå¹¶ä½¿ç”¨ https åŠ è½½</p><pre><code class="http">Content-Security-Policy: default-src https:</code></pre><p>å¦‚æœ <code>script-src</code> è®¾ç½®äº†<code>unsafe-inline</code>ï¼Œåˆ™å¯ä»¥æ‰§è¡Œé¡µé¢å†…çš„å†…è”ä»£ç ã€‚</p><p>æ‰©å±•é˜…è¯»ï¼š<a href="http://www.ruanyifeng.com/blog/2016/09/csp.html" target="_blank" rel="noopener">Content Security Policy å…¥é—¨æ•™ç¨‹</a></p><ul><li>X-Content-Type-Options</li></ul><p>æ­¤å“åº”å¤´æç¤ºå®¢æˆ·ç«¯ä¸€å®šè¦éµå¾ªæ–‡ä»¶æ ‡è¯†çš„ MIME ç±»å‹ï¼Œç¦ç”¨äº†å®¢æˆ·ç«¯çš„ MIME å—…æ¢è¡Œä¸ºã€‚</p><pre><code class="http">X-Content-Type-Options: nosniff</code></pre><ul><li>å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œè½¬ä¹‰ã€‚</li></ul><p>å¸¸è§è½¬ä¹‰ç¬¦å·ï¼š</p><table><thead><tr><th>ç¬¦å·</th><th>è½¬ä¹‰</th></tr></thead><tbody><tr><td>&lt;</td><td><code>&amp;lt;</code></td></tr><tr><td>&gt;</td><td><code>&amp;gt;</code></td></tr><tr><td>&amp;</td><td><code>&amp;amp;</code></td></tr><tr><td>â€œ</td><td><code>&amp;quot;</code></td></tr><tr><td>â€˜</td><td><code>&amp;apos;</code></td></tr></tbody></table><p>ä½¿ç”¨æ­£åˆ™</p><pre><code class="js">function escape(input) {  const sheet = {    &quot;&lt;&quot;: &quot;&amp;lt;&quot;,    &quot;&gt;&quot;: &quot;&amp;gt;&quot;,    &quot;&amp;&quot;: &quot;&amp;amp;&quot;,    &#39;&quot;&#39;: &quot;&amp;quot&quot;,    &quot;&#39;&quot;: `&amp;apos;`,  };  return input.replace(/([&#39;&quot;&lt;&gt;&amp;])/g, (c) =&gt; sheet[c]);}</code></pre><p>æˆ–è€…ä½¿ç”¨ div çš„ <code>innerText</code>çš„æ–¹æ³•ï¼š</p><pre><code class="js">function escape(input) {  let div = document.createElement(&quot;div&quot;);  div.innerText = input;  return div.innerHTML;}</code></pre><h2 id="CSRF-æ”»å‡»"><a href="#CSRF-æ”»å‡»" class="headerlink" title="CSRF æ”»å‡»"></a>CSRF æ”»å‡»</h2><h3 id="å®šä¹‰-1"><a href="#å®šä¹‰-1" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>CSRFï¼ˆCross-site request forgeryï¼Œè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ã€‚åœ¨é’“é±¼ç½‘ç«™åˆ©ç”¨ç”¨æˆ·çš„ç™»å½•å‡­è¯ï¼ˆcookie ç­‰ï¼‰å†’å……ç”¨æˆ·è¿›è¡Œæ“ä½œã€‚</p><h3 id="é˜²å¾¡-1"><a href="#é˜²å¾¡-1" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h3><ul><li>å¯¹è¯·æ±‚ç½‘ç«™çš„é™åˆ¶</li></ul><p>åˆ¤æ–­è¯·æ±‚å¤´ä¸­çš„<code>Referer</code>ã€‚</p><ul><li>Token</li></ul><p><code>Token</code>æ˜¯åœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆçš„éªŒè¯ã€‚å¯ä»¥è®¾ç½®æ¯æ¬¡è¯·æ±‚éƒ½éœ€æºå¸¦ç‰¹å®šçš„<code>Token</code>ã€‚</p><p><strong>session å’Œ token</strong></p><ul><li><code>session</code>ç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œä¿å­˜åœ¨æœåŠ¡ç«¯ã€‚</li><li><code>token</code>ç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œå­˜å‚¨åœ¨å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯è¯·æ±‚æ—¶åœ¨è¯·æ±‚å¤´é‡Œæºå¸¦<code>token</code>ï¼ŒæœåŠ¡ç«¯åªéœ€éªŒè¯è¿”å›çš„<code>token</code>æ˜¯å¦åˆæ³•ã€‚</li></ul><h2 id="æ‰©å±•ï¼šåŒæºç­–ç•¥"><a href="#æ‰©å±•ï¼šåŒæºç­–ç•¥" class="headerlink" title="æ‰©å±•ï¼šåŒæºç­–ç•¥"></a>æ‰©å±•ï¼šåŒæºç­–ç•¥</h2><p>åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªå®‰å…¨åŠŸèƒ½ï¼Œå³é»˜è®¤ï¼ˆæœªæˆæƒæƒ…å†µä¸‹ï¼‰åªæ‰§è¡Œæ¥è‡ªåŒä¸€ä¸ªæºï¼ˆ<code>åè®®</code>ï¼Œ<code>åŸŸå</code>ï¼Œ<code>ç«¯å£</code>éƒ½ç›¸åŒï¼‰çš„èµ„æºã€‚</p><p>å¦‚æœè¿›è¡Œè·¨åŸŸæ“ä½œï¼Œé€šå¸¸ï¼š</p><ul><li>å†™ï¼ˆé“¾æ¥ï¼Œé‡å®šå‘ï¼Œè¡¨å•æäº¤ç­‰ï¼‰ï¼šå…è®¸</li><li>èµ„æºåµŒå…¥ï¼ˆCDN, imgï¼‰ç­‰ï¼šå…è®¸</li><li>è¯»ï¼šä¸å…è®¸</li></ul><ol><li><p>è¯·æ±‚éåŒæºæƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨è¿”å›ç»“æœï¼Œå“åº”å¤´ä¸­æ²¡æœ‰<code>Access-Control-Allow-Origin</code>ç›¸å…³ï¼ˆ=CORSï¼‰ï¼Œåˆ™æµè§ˆå™¨æ‹¦æˆªã€‚</p></li><li><p>å¯ä»¥ä½¿ç”¨<code>&lt;script&gt;</code>è„šæœ¬ src ä¸æ£€æµ‹è·¨æºçš„ç‰¹æ€§ç»•è¿‡åŒæºç­–ç•¥ã€‚ = jsonpï¼Œå°†æ•°æ®å¡«å…¥å›è°ƒå‡½æ•°ã€‚ï¼ˆåªé€‚ç”¨<code>GET</code>è¯·æ±‚ï¼‰ã€‚<br>ç¤ºä¾‹ï¼š</p><pre><code class="html"> &lt;script src=&quot;www.domain.com/api?callback=cb&quot;&gt;</code></pre><pre><code class="js"> function cb(data) {   console.log(data); }</code></pre><p> æœåŠ¡å™¨è„šæœ¬å†…å®¹æ˜¯<code>cb(data)</code>ã€‚ä¹Ÿå°±æ˜¯<strong>æœ¬åœ°å®šä¹‰å‡½æ•°ï¼ŒæœåŠ¡å™¨è°ƒç”¨</strong>ã€‚</p></li><li><p><code>WebSocket</code>ä¸éµå¾ªåŒæºç­–ç•¥ã€‚</p></li></ol><p>å‚è€ƒï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy" target="_blank" rel="noopener">æµè§ˆå™¨çš„åŒæºç­–ç•¥</a></p>]]></content>
      
      
      <categories>
          
          <category> å­¦ä¹  </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>JS ç¬”è®°ï¼šProxy &amp; Reflect</title>
      <link href="2020/04/28/js-proxy/"/>
      <url>2020/04/28/js-proxy/</url>
      
        <content type="html"><![CDATA[<p>Proxy ä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„ä»£ç†â€”â€”åˆ©ç”¨ Proxy æ“ä½œåŸå¯¹è±¡ï¼Œå¯è¦†ç›–åŸå¯¹è±¡çš„æ–¹æ³•ã€‚</p><a id="more"></a><h2 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h2><p>è¦†ç›–/æ·»åŠ å¯¹åŸå¯¹è±¡çš„æ“ä½œã€‚</p><pre><code class="js">const handler = {  get(obj, prop) {    return prop in obj ? obj[prop] + &quot; from proxy&quot; : &quot;do not exist&quot;;  },};var target = { a: 100 };const p = new Proxy(target, handler);console.log(target.a);//100console.log(p.a);//100 from proxyconsole.log(target.b);//undefinedconsole.log(p.b);//do not exist</code></pre><p>å¯¹ä»£ç†çš„æ“ä½œ=å¯¹åŸå¯¹è±¡çš„æ“ä½œ</p><pre><code class="js">var target = { a: 100 };const p = new Proxy(target, {});p.b = &quot;b&quot;;console.log(target.b);//b</code></pre><h2 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h2><p><code>Reflect</code>æ˜¯ä¸€ä¸ªå†…ç½®å¯¹è±¡ï¼Œæä¾›ä¸€äº›åŸç”Ÿçš„æ–¹æ³•ã€‚</p><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">Proxy - MDN</a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect" target="_blank" rel="noopener">Reflect - MDN</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS ç¬”è®°ï¼šåŸå‹</title>
      <link href="2020/04/22/js-prototype/"/>
      <url>2020/04/22/js-prototype/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸå‹"><a href="#åŸå‹" class="headerlink" title="åŸå‹"></a>åŸå‹</h2><p>JavaScript æ˜¯ä¸€ç§åŸºäºåŸå‹çš„è¯­è¨€ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯åŸå‹å¯¹è±¡çš„å®ä¾‹ã€‚</p><p>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ªå«åšåŸå‹(prototype)çš„å±æ€§ã€‚å¯ä»¥æ·»åŠ å±æ€§åˆ° prototype ä¸Šã€‚ä¹‹åå°±å¯ä»¥åˆ©ç”¨<code>new</code>åˆ›é€ æ–°çš„ã€å«æœ‰è¿™ä¸ªå±æ€§çš„å®ä¾‹ã€‚</p><a id="more"></a><pre><code class="js">var Point = function () {};Point.prototype.value = [1, 2];let p = new Point();console.log(p.value);//[1, 2]</code></pre><p>ä½¿ç”¨çš„æ—¶å€™ä¼šé“¾å¼æŸ¥æ‰¾æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ã€‚</p><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>å®šä¹‰åœ¨ <code>prototype</code> ä¸Šçš„å±æ€§ï¼ˆä¸€ä¸ªå¯¹è±¡ï¼‰å¯ä»¥ç»§æ‰¿ã€‚</p><pre><code class="js">var Vehicle = function () {};Vehicle.prototype.color = &quot;red&quot;;Vehicle.seats = 4;console.log(Vehicle.color);//undefinedconsole.log(Vehicle.seats);//4let car = new Vehicle();console.log(car.color);//redconsole.log(car.seats);//undefinedconsole.log(Vehicle);//function(){ }console.log(car);/*{}&lt;prototype&gt;: {â€¦}â€‹color: &quot;red&quot;â€‹â€‹constructor: function Vehicle()*/</code></pre><ul><li><code>Vehicle.color</code> è¾“å‡º <code>undefined</code>ï¼Œ<code>car.color</code> ä¸æ˜¯ï¼Œ è€Œ <code>Vehicle.seats</code> å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ <strong>å®šä¹‰åœ¨<code>prototype</code>ä¸Šçš„å±æ€§å½“å‰å¯¹è±¡ä¸èƒ½ä½¿ç”¨ï¼Œç»§æ‰¿å¯¹è±¡æ‰èƒ½ä½¿ç”¨ã€‚</strong></li><li>éœ€è¦ç»§æ‰¿çš„å±æ€§å®šä¹‰åœ¨ <code>prototype</code> ä¸Šï¼Œæ¯”å¦‚è¯´ <code>car</code> èƒ½ä½¿ç”¨ <code>color</code> è€Œä¸èƒ½ä½¿ç”¨ <code>seats</code>ã€‚</li><li><code>car.__proto__</code> å°±æ˜¯å¯¹è±¡<code>Vehicle</code>ã€‚</li></ul><h2 id="proto-å’Œ-prototype"><a href="#proto-å’Œ-prototype" class="headerlink" title="__proto__ å’Œ prototype"></a><code>__proto__</code> å’Œ <code>prototype</code></h2><blockquote><p>æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆ object ï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º <strong>proto</strong> ï¼‰æŒ‡å‘å®ƒçš„<em>æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡</em>ï¼ˆprototypeï¼‰ã€‚</p></blockquote><p>åœ¨æŸ¥æ‰¾å±æ€§æ˜¯å¦å­˜åœ¨çš„æ—¶å€™ï¼Œå…ˆæŸ¥æ‰¾å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œä¸ç„¶å°±æŸ¥æ‰¾å…¶ <code>__proto__</code> ä¸­æ˜¯å¦å­˜åœ¨ï¼Œç„¶åæ˜¯ <code>__proto__</code> æŒ‡å‘çš„å¯¹è±¡çš„ <code>__proto__</code> ä¸­æ˜¯å¦å­˜åœ¨ï¼Œç›´åˆ° <code>__proto__</code> ä¸º <code>null</code>ã€‚</p><h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><p>åŒ¿åå‡½æ•°çš„<code>prototype</code>ï¼š</p><pre><code class="js">const cola = () =&gt; &quot;Give me cola!&quot;;console.log(cola);//() =&gt; &quot;Give me cola!&quot;console.log(cola.prototype);//undefinedconsole.log(cola.__proto__);//function () {//  [native code]//}</code></pre><p>å‚è€ƒèµ„æ–™ï¼š</p><ul><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/Object_prototypes" target="_blank" rel="noopener">å¯¹è±¡åŸå‹ - MDN</a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank" rel="noopener">ç»§æ‰¿ä¸åŸå‹é“¾ - MDN</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JS ç¬”è®°ï¼šç±»çš„ç”¨æ³•</title>
      <link href="2020/04/21/js-class/"/>
      <url>2020/04/21/js-class/</url>
      
        <content type="html"><![CDATA[<p>ç±»æ˜¯ ES6 å¼•è¿›çš„æ–°å†™æ³•ã€‚å®é™…ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ã€‚</p><a id="more"></a><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¦å…ˆå£°æ˜ç±»æ‰èƒ½è®¿é—®ã€‚å®šä¹‰ç±»ï¼š</p><pre><code class="js">class Vehicle {  _color = &quot;black&quot;;  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }}let car = new Vehicle(&quot;red&quot;, &quot;s&quot;, 4);</code></pre><ul><li>ç±»çš„æ„é€ å‡½æ•°ä¸º<code>constructor</code>ï¼Œåªèƒ½æœ‰ä¸€ä¸ªã€‚å¯ä»¥ç”¨<code>super</code>è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚</li><li>ç±»ä¸­ï¼Œå¯¹è±¡æ— <code>this</code>å€¼çš„æ—¶å€™ä¼šè¿”å›<code>undefined</code>ï¼Œä¸ä¼šè‡ªåŠ¨å®šä¹‰<code>this</code>å€¼ã€‚è€Œç”¨åŸå‹æ–¹æ³•å®šä¹‰ç±»åˆ™ä¼šè‡ªåŠ¨å®šä¹‰<code>this</code>ã€‚</li><li>ç±»ä¸­çš„<strong>å®ä¾‹å±æ€§</strong>å¿…é¡»å®šä¹‰åœ¨ç±»çš„æ–¹æ³•é‡Œã€‚ <strong>é™æ€å±æ€§</strong>åœ¨ç±»å®šä¹‰çš„å¤–é¢ã€‚</li></ul><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }}let car = new Vehicle(&quot;red&quot;, &quot;s&quot;, 4);</code></pre><h2 id="Getter-å’Œ-Setter"><a href="#Getter-å’Œ-Setter" class="headerlink" title="Getter å’Œ Setter"></a>Getter å’Œ Setter</h2><p>ä¾¿äºè¿”å›ä¸€äº›éœ€è¦åŠ¨æ€è®¡ç®—çš„å€¼ï¼Œå®šä¹‰åœ¨åŸå‹ä¸Šã€‚</p><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }  get seats() {    return this._seats + &quot; seats&quot;;  }  set seats(s) {    this._seats = s;  }}const car = new Vehicle(&quot;red&quot;, &quot;s&quot;, 4);console.log(car.seats);//4 seatscar.seats = 5;console.log(car.seats);//5 seats</code></pre><h2 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h2><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }  static isVehicle() {    return true;  }}console.log(Vehicle.isVehicle());//true</code></pre><h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h2><p>ä¼šè°ƒç”¨çˆ¶çº§çš„æ„é€ å‡½æ•°ã€‚</p><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }  get seats() {    return `${this._seats} seats`;  }  set seats(s) {    this._seats = s;  }}class Car extends Vehicle {  //è¦†ç›–äº†çˆ¶çº§  get seats() {    return &quot;4 seats&quot;;  }  get color() {    return `The car&#39;s color is ${this._color}`;  }}const car = new Car(&quot;red&quot;, &quot;s&quot;, 100);console.log(car.seats);//4 seatsconsole.log(car.color);//The car&#39;s color is red</code></pre><p>è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œä¸€å®šè¦è°ƒç”¨ super()ã€‚</p><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }  get seats() {    return this._seats + &quot; seats&quot;;  }  set seats(s) {    this._seats = s;  }}class Car extends Vehicle {  constructor(color, size, seats) {    //ä¸è°ƒç”¨ super ä¼šæŠ¥é”™    super(&quot;blue&quot;, size, seats);  }  get seats() {    return &quot;4 seats&quot;;  }  get color() {    return &quot;The car&#39;s color is &quot; + this._color;  }}const car = new Car(&quot;red&quot;, &quot;s&quot;, 100);console.log(car.seats);//4 seatsconsole.log(car.color);//The car&#39;s color is blue</code></pre><h2 id="æŠ½è±¡ï¼Ÿ"><a href="#æŠ½è±¡ï¼Ÿ" class="headerlink" title="æŠ½è±¡ï¼Ÿ"></a>æŠ½è±¡ï¼Ÿ</h2><p>ä¸€ä¸ª js çš„ç±»åªèƒ½æœ‰<strong>ä¸€ä¸ª</strong>çˆ¶ç±»ã€‚</p><p>çˆ¶ç±»çš„å®šä¹‰å­ç±»å»å®ç°ã€‚æ²¡æ‰¾åˆ°å…³äºæŠ½è±¡å‡½æ•°çš„èµ„æ–™ï¼Œå†™ä¸ªç±»ä¼¼çš„å§ã€‚</p><pre><code class="js">class Vehicle {  //æ„é€ å‡½æ•°  constructor(color, size, seats) {    this._color = color;    this._size = size;    this._seats = seats;  }  get seats() {    return this._seats + &quot; seats&quot;;  }  set seats(s) {    this._seats = s;  }  description() {    throw new Error(&quot;ä¸èƒ½ä½¿ç”¨æŠ½è±¡æ–¹æ³•ï¼&quot;);  }}class Car extends Vehicle {  description() {    console.log(`a ${this._color} car with ${this._seats} seats. `);  }}const car = new Car(&quot;red&quot;, &quot;s&quot;, 100);car.description();//a red car with 100 seats.const v = new Vehicle(&quot;res&quot;, &quot;s&quot;, 100);try {  v.description();} catch (e) {  console.log(e);}//Error: &quot;ä¸èƒ½ä½¿ç”¨æŠ½è±¡æ–¹æ³•ï¼&quot;</code></pre><p>å‚è€ƒèµ„æ–™:</p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Classes</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elm ç¬”è®°ï¼ˆ3ï¼‰ï¼šè¡¨å•</title>
      <link href="2020/04/16/elm-note-forms/"/>
      <url>2020/04/16/elm-note-forms/</url>
      
        <content type="html"><![CDATA[<p><a href="https://guide.elm-lang.org/architecture/forms.html" target="_blank" rel="noopener">å®˜æ–¹ä¾‹å­ä¸‰ï¼š Forms</a> å­¦ä¹ </p><a id="more"></a><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><pre><code class="elm">type Msg  = Name String  | Password String  | PasswordAgain Stringupdate : Msg -&gt; Model -&gt; Modelupdate msg model =  case msg of    Name name -&gt;      { model | name = name }    Password password -&gt;      { model | password = password }    PasswordAgain password -&gt;      { model | passwordAgain = password }</code></pre><ul><li>æ¥æ”¶æ¯ä¸ªç±»å‹çš„æ¶ˆæ¯å¹¶ä¿®æ”¹<code>Record</code>ã€‚</li></ul><h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><pre><code class="elm">view : Model -&gt; Html Msgview model =  div []    [ viewInput &quot;text&quot; &quot;Name&quot; model.name Name    , viewInput &quot;password&quot; &quot;Password&quot; model.password Password    , viewInput &quot;password&quot; &quot;Re-enter Password&quot; model.passwordAgain PasswordAgain    , viewValidation model    ]</code></pre><ul><li>è¿™é‡Œæ²¡åƒå‰é¢ä¸€æ ·ä½¿ç”¨æ™®é€šçš„<code>input</code>ï¼Œè€Œä½¿ç”¨äº†å‡½æ•°,æ–¹ä¾¿ç»Ÿä¸€å»ºç«‹å’Œä¿®æ”¹ã€‚</li></ul><pre><code class="elm">viewInput : String -&gt; String -&gt; String -&gt; (String -&gt; msg) -&gt; Html msgviewInput t p v toMsg =  input [ type_ t, placeholder p, value v, onInput toMsg ] []</code></pre><ul><li><code>viewInput</code>å‡½æ•°ï¼Œè¾“å…¥ input ç±»å‹ï¼Œå ä½ç¬¦ï¼Œç»‘å®šçš„å€¼å’Œå“åº”å‡½æ•°ç”Ÿæˆæ–‡æœ¬æ¡†ã€‚</li></ul><pre><code class="elm">viewValidation : Model -&gt; Html msgviewValidation model =  if model.password == model.passwordAgain then    div [ style &quot;color&quot; &quot;green&quot; ] [ text &quot;OK&quot; ]  else    div [ style &quot;color&quot; &quot;red&quot; ] [ text &quot;Passwords do not match!&quot; ]</code></pre><ul><li><code>viewValidation</code>éªŒè¯è¾“å…¥çš„å‡½æ•°ã€‚</li></ul><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>æœ€åå®Œæˆæ–‡æ¡£åç•™çš„ä½œä¸šï¼š</p><ol><li>éªŒè¯ï¼šå¯†ç å¿…é¡»é•¿äº 8 ä½ã€‚</li><li>éªŒè¯ï¼šå¯†ç å¿…é¡»å«æœ‰å¤§å†™ã€å°å†™å­—æ¯å’Œæ•°å­—ã€‚</li></ol><p>ï¼ˆç«Ÿç„¶ç»•äº†ä¸ªå¤§åœˆå­å»çœ‹<code>elm/parser</code>â€¦â€¦å…¶å®æ ¹æœ¬ç”¨ä¸åˆ°ï¼‰</p><pre><code class="elm">module Form exposing (main)import Browserimport Html exposing (Html, div, input, text)import Html.Attributes exposing (placeholder, style, type_, value)import Html.Events exposing (onInput)-- MAINmain : Program () Model Msgmain =    Browser.sandbox { init = init, update = update, view = view }-- MODELtype alias Model =    { name : String    , password : String    , passwordAgain : String    }init : Modelinit =    Model &quot;&quot; &quot;&quot; &quot;&quot;-- UPDATEtype Msg    = Name String    | Password String    | PasswordAgain Stringupdate : Msg -&gt; Model -&gt; Modelupdate msg model =    case msg of        Name name -&gt;            { model | name = name }        Password password -&gt;            { model | password = password }        PasswordAgain password -&gt;            { model | passwordAgain = password }-- VIEWview : Model -&gt; Html Msgview model =    div []        [ viewInput &quot;text&quot; &quot;Name&quot; model.name Name        , viewInput &quot;password&quot; &quot;Password&quot; model.password Password        , viewInput &quot;password&quot; &quot;Re-enter Password&quot; model.passwordAgain PasswordAgain        , viewValidation model        ]viewInput : String -&gt; String -&gt; String -&gt; (String -&gt; msg) -&gt; Html msgviewInput t p v toMsg =    input [ type_ t, placeholder p, value v, onInput toMsg ] []viewValidation : Model -&gt; Html msgviewValidation model =    -- elm ä½¿ç”¨ /= è¡¨ç¤º !=    if model.password /= model.passwordAgain then        div [ style &quot;color&quot; &quot;red&quot; ] [ text &quot;å¯†ç ä¸åŒ¹é…&quot; ]    else if String.length model.password &lt; 8 then        div [ style &quot;color&quot; &quot;red&quot; ] [ text &quot;å¯†ç å¿…é¡»é•¿äº8ä½&quot; ]    else if String.length (String.filter Char.isDigit model.password) == 0 || String.length (String.filter Char.isUpper model.password) == 0 || String.length (String.filter Char.isLower model.password) == 0 then        div [ style &quot;color&quot; &quot;red&quot; ] [ text &quot;å¯†ç å¿…é¡»å«æœ‰å¤§å†™ã€å°å†™å­—æ¯å’Œæ•°å­—ã€‚&quot; ]    else        div [ style &quot;color&quot; &quot;green&quot; ] [ text &quot;é€šè¿‡&quot; ]</code></pre>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elm ç¬”è®°ï¼ˆ1ï¼‰ï¼šè®¡æ•°å™¨</title>
      <link href="2020/03/27/elm-note-counter/"/>
      <url>2020/03/27/elm-note-counter/</url>
      
        <content type="html"><![CDATA[<p>æƒ³å­¦ç‚¹æ–°ä¸œè¥¿ï¼ŒåŒæ—¶çœ‹ä¸‹å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥å¼€å§‹çœ‹<code>Elm</code>ã€‚ä¸è¿‡å‡½æ•°å¼ç¼–ç¨‹å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªé™Œç”Ÿäº†ï¼Œæ‰€ä»¥å¼ºåˆ¶è‡ªå·±å†™ç‚¹åšæ–‡ç†è§£ã€‚</p><p>åˆæ­¥ç›®æ ‡æ˜¯æ ¹æ®å®˜æ–¹æ–‡æ¡£çš„ä¸‰ä¸ªä¾‹å­ï¼ˆ<code>Buttons</code>,<code>Text Fields</code>,<code>Forms</code>ï¼‰æ¥åšåˆ†æã€‚è¿™ç¯‡æ˜¯ç¬¬ä¸€ç¯‡ï¼Œæ ¹æ®<code>Button</code>çš„è®¡æ•°å™¨ã€‚</p><a id="more"></a><p><a href="https://guide.elm-lang.org/architecture/buttons.html" target="_blank" rel="noopener">ğŸ“ å®˜æ–¹ä¾‹å­åœ°å€</a></p><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h3 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h3><pre><code class="Elm">-- MAINmain =  Browser.sandbox { init = init, update = update, view = view }</code></pre><ul><li><code>main</code>åœ¨ Elm é‡Œæ˜¯ä¸ªç‰¹æ®Šçš„å€¼ï¼Œå®ƒæè¿°ä»€ä¹ˆè¯¥æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚è¿™é‡Œç¨‹åºå°†ç”¨<code>init</code>åˆå§‹åŒ–,<code>view</code>æ˜¾ç¤ºï¼Œ<code>update</code>å¡«å……ç”¨æˆ·è¾“å…¥ã€‚</li><li><code>Browser.sandbox</code>ï¼š<code>Browser</code>æ˜¯ Elm çš„æµè§ˆå™¨æ¨¡å—ï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„<code>Elm</code>ç¨‹åºã€‚<code>Browser</code>ä¸‹ä¸åŒçš„æ¨¡å—å¯¹é¡µé¢æœ‰ä¸åŒçš„æ§åˆ¶èƒ½åŠ›ï¼š<ul><li><code>sandbox</code>åªå¤„ç†å’Œç”¨æˆ·çš„äº¤äº’ï¼Œä¸èƒ½é€šä¿¡ï¼›</li><li><code>element</code>èƒ½å¯¹å¤–é€šä¿¡ï¼›</li><li><code>document</code>åœ¨å…¶ä¸Šèƒ½æ§åˆ¶é¡µé¢çš„ title, body ç­‰å…ƒç´  ï¼›</li><li><code>application</code>åˆ¶ä½œå®Œæ•´çš„å•é¡µ appã€‚<br>èƒ½è¾“å…¥çš„å‚æ•°ä¹Ÿä¸åŒï¼Œä¸‹ç•¥ã€‚å‚è€ƒ<a href="https://guide.elm-lang.org/effects/" target="_blank" rel="noopener">è¿™ä¸ªé¡µé¢ä¸­å¯¹ Elm è¿è¡Œæ—¶çš„è¯´æ˜</a></li></ul></li></ul><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><pre><code class="Elm">-- MODELtype alias Model = Intinit : Modelinit =  0</code></pre><ul><li>æ•°æ®æ¨¡å‹ç®¡ç†æ‰€æœ‰ç¨‹åºæ•°æ®çš„ç»†èŠ‚ã€‚åœ¨è®¡æ•°å™¨ç¨‹åºä¸­å°±æ˜¯è®¡æ•°çš„æ•°é‡ã€‚</li><li><code>type alias</code>è¡¨ç¤ºç±»å‹åˆ«åï¼Œè¿™é‡Œç”¨<code>Model</code>æŒ‡<code>Int</code>å‹ã€‚</li></ul><h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><pre><code class="Elm">-- VIEWview : Model -&gt; Html Msgview model =  div []    [ button [ onClick Decrement ] [ text &quot;-&quot; ]    , div [] [ text (String.fromInt model) ]    , button [ onClick Increment ] [ text &quot;+&quot; ]    ]</code></pre><ul><li><code>view</code>æè¿°æ•°æ®æ˜¾ç¤ºçš„æ–¹æ³•ã€‚</li><li><code>view : Model -&gt; Html Msg</code>è¡¨ç¤º<code>view</code>ä¸ºæ¥å—<code>Model</code>ç±»å‹ï¼Œè¾“å‡º<code>Html Msg</code>ç±»å‹çš„å‡½æ•°ã€‚</li><li>Elm ä¸­çš„å‡½æ•°å’Œé€šå¸¸çš„è¡¨ç°æ–¹æ³•ä¸ä¸€æ ·ï¼Œä¸º<code>&lt;å‡½æ•°å&gt; [å‚æ•°...]&gt;</code>ã€‚<code>view model</code>å³ä¸ºå‚æ•°ä¸º<code>model</code>çš„<code>view</code>å‡½æ•°ã€‚</li></ul><h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><pre><code class="Elm">-- UPDATEtype Msg = Increment | Decrementupdate : Msg -&gt; Model -&gt; Modelupdate msg model =  case msg of    Increment -&gt;      model + 1    Decrement -&gt;      model - 1</code></pre><ul><li><code>update</code>å‡½æ•°æè¿°<code>model</code>å¦‚ä½•å˜åŒ–ã€‚</li><li><code>type Msg = Increment | Decrement</code>å®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰ç±»å‹<code>Msg</code>ã€‚å®ƒå¯ä»¥ä¸º<code>Increment</code>ä¹Ÿå¯ä»¥æ˜¯<code>Decrement</code>ã€‚</li><li><code>update : Msg -&gt; Model -&gt; Model</code>è¡¨ç¤º<code>update</code>æ¥å—<code>Msg</code>ç±»å‹ï¼Œè¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼ˆè¾“å…¥<code>Model</code>ï¼Œè¾“å‡º<code>Model</code>ç±»å‹çš„å‡½æ•°ï¼‰ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œæ¯ä¸ªå‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œä½†å®ƒå¯ä»¥è¿”å›å¸¦æ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°ã€‚è¡¨ç°èµ·æ¥å°±åƒæ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°ã€‚<a href="https://guide.elm-lang.org/appendix/function_types.html" target="_blank" rel="noopener">ï¼ˆè§è¿™é‡Œï¼‰</a></li></ul><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>æœ€åå®Œæˆæ–‡æ¡£åç•™çš„ä½œä¸šï¼šç»™è®¡æ•°å™¨æ·»åŠ â€œé‡ç½®â€é”®ã€‚</p><pre><code class="Elm">module Main exposing (..)import Browserimport Html exposing (Html, button, div, text)import Html.Events exposing (onClick)-- MAINmain =  Browser.sandbox { init = init, update = update, view = view }-- MODELtype alias Model = Intinit : Modelinit =  0-- UPDATEtype Msg = Increment | Decrement | Resetupdate : Msg -&gt; Model -&gt; Modelupdate msg model =  case msg of    Increment -&gt;      model + 1    Decrement -&gt;      model - 1    Reset -&gt;      0-- VIEWview : Model -&gt; Html Msgview model =  div []    [ button [ onClick Decrement ] [ text &quot;-&quot; ]    , div [] [ text (String.fromInt model) ]    , button [ onClick Increment ] [ text &quot;+&quot; ]    , button [ onClick Reset ] [ text &quot;Reset&quot; ]    ]</code></pre>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Elm ç¬”è®°ï¼ˆ2ï¼‰ï¼šæ–‡æœ¬æ¡†</title>
      <link href="2020/03/27/elm-note-text/"/>
      <url>2020/03/27/elm-note-text/</url>
      
        <content type="html"><![CDATA[<p><a href="https://guide.elm-lang.org/architecture/text_fields.html" target="_blank" rel="noopener">å®˜æ–¹ä¾‹å­äºŒï¼šText Fields</a> å­¦ä¹ ã€‚</p><a id="more"></a><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><h3 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h3><pre><code class="elm">type alias Model =  { content : String  }</code></pre><ul><li>è¿™ä¸ªç¤ºä¾‹çš„åŠŸèƒ½æ˜¯â€œåè½¬ç”¨æˆ·è¾“å…¥çš„æ–‡å­—â€ï¼Œè¿™é‡Œå°†<code>Model</code>è®¾ç½®ä¸º<code>Record</code>ç±»å‹æ–¹ä¾¿ä»¥åæ·»åŠ æ›´å¤šçš„æ•°æ®ã€‚</li><li><code>Record</code>ï¼š<code>Record</code>ç±»å‹å¯ä»¥åŒ…å«è®¸å¤šå€¼ï¼Œæ¯ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªåç§°ï¼ˆæˆ‘ç†è§£ä¸º key-value å‹)ã€‚</li></ul><h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><pre><code class="elm">view : Model -&gt; Html Msgview model =  div []    [ input [ placeholder &quot;Text to reverse&quot;, value model.content, onInput Change ] []    , div [] [ text (String.reverse model.content) ]    ]</code></pre><ul><li>åˆ›å»ºä¸€ä¸ªå«ä¸¤ä¸ªå­å…ƒç´ çš„<code>div</code>ã€‚</li><li>æ³¨æ„åˆ°æ¯ä¸ªå…ƒç´ éƒ½æ˜¯<code>&lt;å…ƒç´ å&gt; [&lt;å…ƒç´ å±æ€§&gt;] [&lt;å†…éƒ¨å†…å®¹&gt;]</code>çš„å½¢å¼ã€‚</li><li>åªè¦ç”¨æˆ·åœ¨ input å†…è¾“å…¥æ—¶ï¼Œ<code>onInput</code>å°±ä¼šå‘é€æ•°æ®ã€‚ï¼ˆæ¯ä¸ªå­—ç¬¦éƒ½ä¼šï¼‰</li></ul><h3 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h3><pre><code class="elm">type Msg  = Change Stringupdate : Msg -&gt; Model -&gt; Modelupdate msg model =  case msg of    Change newContent -&gt;      { model | content = newContent }</code></pre><ul><li>æœ¬ä¾‹ä¸­åªæœ‰ä¸€ç§<code>Msg</code>å½¢å¼</li><li><code>{ model | content = newContent }</code> è¡¨ç¤ºä¿®æ”¹<code>model</code>ä¸­<code>content</code>çš„å€¼ä¸º<code>newContent</code>ã€‚</li></ul><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>æœ€åå®Œæˆæ–‡æ¡£åç•™çš„ä½œä¸šï¼šæ˜¾ç¤ºè¾“å…¥çš„å­—ç¬¦çš„é•¿åº¦</p><pre><code class="elm">-- åªä¿®æ”¹ view éƒ¨åˆ†view : Model -&gt; Html Msgview model =  div []    [ input [ placeholder &quot;Text to reverse&quot;, value model.content, onInput Change ] []    , div [] [ text (String.reverse model.content) ]    , div [] [ text (String.fromInt (String.length model.content)) ]    ]</code></pre>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Elm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Three.js ç¬”è®°ï¼ˆ4ï¼‰ åŠ è½½glTFæ¨¡å‹</title>
      <link href="2020/03/27/webgl-note-4/"/>
      <url>2020/03/27/webgl-note-4/</url>
      
        <content type="html"><![CDATA[<p>ğŸ¯ç›®æ ‡ï¼š1. å°†æ¨¡å‹å¯¼æˆglTF 2.åœ¨ç½‘é¡µæ˜¾ç¤ºæ¨¡å‹</p><a id="more"></a><p>é¸½äº†å‡ å¤©ç»§ç»­ï¼Œæƒ³åˆ°ä»€ä¹ˆæŸ¥ä»€ä¹ˆã€‚</p><h2 id="1-glTF"><a href="#1-glTF" class="headerlink" title="1. glTF"></a>1. glTF</h2><p>åœ¨æŸæ¨¡å‹ç½‘ç«™ä¸Šçœ‹åˆ°ä½¿ç”¨è¯´æ˜ä¸­æåˆ°ï¼šâ€œä¸èƒ½ç›´æ¥äºŒæ¬¡å‘å¸ƒæ¨¡å‹ï¼Œä½†å¦‚æœè½¬æˆç½‘é¡µç”¨çš„ï¼Œä¸èƒ½ç›´æ¥è¯»å–çš„æ ¼å¼æ¯”å¦‚gltfåˆ™å¯ä»¥å‘å¸ƒâ€ï¼Œæ‰€ä»¥æ¥çœ‹ä¸€ä¸‹gltfæ˜¯ä»€ä¹ˆã€‚</p><p>glTF(<a href="https://github.com/KhronosGroup/glTF-Tutorials/blob/master/gltfTutorial/gltfTutorial_001_Introduction.md" target="_blank" rel="noopener">åº”è¯¥æ˜¯å®˜æ–¹ä»‹ç»</a>)æ˜¯åˆ©äºé«˜æ•ˆæ¸²æŸ“ã€ä¼ è¾“çš„ä¸€ç§æ ¼å¼ï¼Œä¸»è¦åœ¨ç›®æ ‡è¿è¡Œæ—¶ä¸­ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨3Dè½¯ä»¶åˆ¶ä½œå®Œæˆåçš„æ–‡ä»¶ï¼Œæœ€åè½¬æ¢æˆglTFåœ¨ç¨‹åºä¸­ä½¿ç”¨ã€‚</p><p>å°†æ¨¡å‹å¯¼æˆglTFï¼Œç›´æ¥å»æ‰¾å·¥å…·ã€‚è¿™é‡Œä½¿ç”¨Blenderçš„æ’ä»¶<a href="https://github.com/KhronosGroup/glTF-Blender-IO" target="_blank" rel="noopener">glTF-Blender-IO</a>ï¼ˆBlenderè‡ªå¸¦ï¼‰å°†æ¨¡å‹å¯¼å‡ºä¸º<code>glTF</code>æ ¼å¼</p><h2 id="2-åŠ è½½"><a href="#2-åŠ è½½" class="headerlink" title="2. åŠ è½½"></a>2. åŠ è½½</h2><p>åŠ è½½å°±ç”¨å¸¸ç”¨çš„åº“å§ï¼Œè¿™é‡Œä½¿ç”¨<code>three.js</code>ã€‚æŸ¥çœ‹æ•™ç¨‹ï¼Œå¾—ï¼Œæ‰€æœ‰çš„éƒ½ç”¨threejså†™å§ï¼ˆæ‰€ä»¥æ ‡é¢˜æ”¹æ‰äº†ğŸ˜‚ï¼‰</p><h3 id="2-1-HTMLç»“æ„"><a href="#2-1-HTMLç»“æ„" class="headerlink" title="2.1 HTMLç»“æ„"></a>2.1 HTMLç»“æ„</h3><p>ç”±äºæ˜¯åœ¨three.jsé‡Œå°†<code>canvas</code>æŒ‚åœ¨htmlä¸‹ï¼Œæ‰€ä»¥å‡†å¤‡ä¸€ä¸ªç©ºçš„htmlå°±å¯ä»¥äº†ã€‚</p><pre><code class="html">&lt;!DOCTYPE html&gt;&lt;html&gt;    &lt;head&gt;        &lt;meta charset=&quot;utf-8&quot;&gt;        &lt;title&gt;webgl&lt;/title&gt;        &lt;style&gt;            body { margin: 0; }            canvas { display: block; }        &lt;/style&gt;    &lt;/head&gt;    &lt;body&gt;        &lt;script src=&quot;libs/three.js&quot;&gt;&lt;/script&gt;        &lt;script src=&quot;libs/GLTFLoader.js&quot;&gt;&lt;/script&gt;        &lt;script src=&quot;æˆ‘ä»¬çš„jsçš„è·¯å¾„&quot;&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="2-2-å»ºç«‹åœºæ™¯"><a href="#2-2-å»ºç«‹åœºæ™¯" class="headerlink" title="2.2 å»ºç«‹åœºæ™¯"></a>2.2 å»ºç«‹åœºæ™¯</h3><p>åœ¨jsæ–‡ä»¶é‡Œæ–°å»ºä¸€ä¸ªthree.jsåœºæ™¯</p><pre><code class="js">var scene = new THREE.Scene();//è®¾ç½®æ‘„åƒæœºï¼Œå‚æ•°åˆ†åˆ«æ˜¯ fov, é•¿å®½æ¯”ï¼Œ è¿‘/è¿œçš„å‰ªåˆ‡å¹³é¢var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );var renderer = new THREE.WebGLRenderer();renderer.setSize( window.innerWidth, window.innerHeight );//canvasæŒ‚è½½document.body.appendChild( renderer.domElement );//ç”±äºåœ¨åŸç‚¹åŠ è½½æ¨¡å‹ï¼Œæ‹‰å¼€æ‘„åƒæœºcamera.position.z = 10;</code></pre><h3 id="2-3-åŠ è½½æ¨¡å‹"><a href="#2-3-åŠ è½½æ¨¡å‹" class="headerlink" title="2.3 åŠ è½½æ¨¡å‹"></a>2.3 åŠ è½½æ¨¡å‹</h3><p>ç”¨æœ€ç®€åŒ–çš„ä»£ç ã€‚æ³¨æ„<code>GLTFLoader</code>ä¸åŒ…å«åœ¨threejsæœ¬èº«ï¼Œæ˜¯å¦å¤–çš„ä¸€ä¸ªjsæ–‡ä»¶â€¦â€¦</p><pre><code class="js">var loader = new THREE.GLTFLoader();loader.load(    &#39;monkey.glb&#39;,    //åŠ è½½å®Œå    function ( gltf ) {        scene.add( gltf.scene ) //æ·»åŠ åˆ°åœºæ™¯    }//å…¶ä»–çš„æš‚æ—¶ä¸éœ€è¦);</code></pre><h3 id="2-4-æ¸²æŸ“"><a href="#2-4-æ¸²æŸ“" class="headerlink" title="2.4 æ¸²æŸ“"></a>2.4 æ¸²æŸ“</h3><p>å‡†å¤‡ä¸€ä¸ªæ¸²æŸ“å‡½æ•°å®æ–½æ¸²æŸ“ã€‚ç»æµ‹è¯•ï¼Œå¿…é¡»è¦å¾ªç¯æ¸²æŸ“ã€‚</p><pre><code class="js">function animate() {  requestAnimationFrame(animate);  renderer.render(scene, camera);}animate();</code></pre><h3 id="2-5-éšä¾¿åŠ ç‚¹ç¯å…‰"><a href="#2-5-éšä¾¿åŠ ç‚¹ç¯å…‰" class="headerlink" title="2.5 éšä¾¿åŠ ç‚¹ç¯å…‰"></a>2.5 éšä¾¿åŠ ç‚¹ç¯å…‰</h3><p>åŠ å®Œäº†å‘ç°è¿˜æ˜¯ä¸€ç‰‡æ¼†é»‘ï¼Œæƒ³äº†æƒ³ï¼Œå“¦ï¼Œæ²¡åŠ ç¯å…‰ã€‚</p><pre><code class="js">var pointLight = new THREE.PointLight(0xffffff, 1, 100);pointLight.position.set(10, 10, 10);scene.add(pointLight);</code></pre><p>ç›®å‰æ²¡ä¸“å¿ƒthree.jsè¿™é‡Œï¼Œæ‰€ä»¥åªæ˜¯æ½¦è‰åœ°çœ‹äº†ä¸€ä¸‹â€¦â€¦</p><p>åˆ°æ—¶å€™çœŸè¦ç”¨å†é‡æ¥ä¸€é.jpg</p><p><strong>å‚è€ƒèµ„æ–™</strong></p><ul><li><a href="https://threejs.org/docs/index.html#manual/en/introduction/Creating-a-scene" target="_blank" rel="noopener">Three js æ–‡æ¡£ Creating a scene</a></li><li><a href="https://threejs.org/docs/index.html#examples/en/loaders/GLTFLoader" target="_blank" rel="noopener">Three js æ–‡æ¡£ GLTFLoader</a></li><li><a href="https://threejs.org/docs/index.html#api/en/helpers/PointLightHelper" target="_blank" rel="noopener">Three js æ–‡æ¡£ PointLightHelper</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebGL </tag>
            
            <tag> Three.js </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebGL ç¬”è®°ï¼ˆ3ï¼‰ çº¹ç†</title>
      <link href="2020/03/14/webgl-note-3/"/>
      <url>2020/03/14/webgl-note-3/</url>
      
        <content type="html"><![CDATA[<p>ğŸ¯ ç›®æ ‡ï¼šè´´çº¹ç†</p><a id="more"></a><p>åœ¨å¹³é¢ä¸Šè´´çº¹ç†ã€‚</p><h2 id="1-è¯»å–çº¹ç†"><a href="#1-è¯»å–çº¹ç†" class="headerlink" title="1. è¯»å–çº¹ç†"></a>1. è¯»å–çº¹ç†</h2><blockquote><p>å‚è€ƒèµ„æ–™ï¼šMDN çš„<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL" target="_blank" rel="noopener">åŠ è½½çº¹ç†</a></p></blockquote><p>å› ä¸ºåªç”»ä¸€æ¬¡ï¼Œæ‰€ä»¥ç»˜å›¾å‡½æ•°å†™åœ¨äº†åŠ è½½å›¾åƒçš„å›è°ƒåï¼Œä¿è¯è®¾ç½®å®Œåå†ç»˜åˆ¶çº¹ç†ã€‚</p><pre><code class="js">function loadTexture(gl, shaderProgram, imageSrc) {  let texture = gl.createTexture();  let image = new Image();  image.src = imageSrc;  //åŠ è½½å®Œå›¾åƒåæ‰§è¡Œçš„å‡½æ•°  image.onload = function () {    //ç»‘å®šçº¹ç†    gl.bindTexture(gl.TEXTURE_2D, texture);    //æŒ‡å®šäºŒç»´çº¹ç†è´´å›¾ï¼Œè¯¦ç»†çº§åˆ«ã€‚é¢œè‰²ç»„ä»¶ï¼Œæ•°æ®æ ¼å¼ï¼Œæ•°æ®ç±»å‹ï¼Œæ•°æ®æº    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);    //è®¾ç½®çº¹ç†åœ¨æ”¾å¤§å’Œç¼©å°æ—¶å€™é‡‡ç”¨çš„é‡‡æ ·æ–¹æ¡ˆã€‚    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);    gl.texParameteri(      gl.TEXTURE_2D,      gl.TEXTURE_MIN_FILTER,      gl.LINEAR_MIPMAP_NEAREST    );    //ç”Ÿæˆmipmap    gl.generateMipmap(gl.TEXTURE_2D);    //ç»‘å®šçº¹ç†    gl.activeTexture(gl.TEXTURE0); //TEXTURE0é»˜è®¤æ¿€æ´»ï¼Œæ³¨é‡Šæ‰ä¹Ÿè¡Œ    //ä¼ å…¥çº¹ç†æ•°æ®åˆ°ç€è‰²å™¨    gl.uniform1i(gl.getUniformLocation(shaderProgram, &quot;uSampler&quot;), 0);    //ç»˜åˆ¶    gl.useProgram(shaderProgram);    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);  };  return texture;}</code></pre><h2 id="2-ä¿®æ”¹ç€è‰²å™¨"><a href="#2-ä¿®æ”¹ç€è‰²å™¨" class="headerlink" title="2. ä¿®æ”¹ç€è‰²å™¨"></a>2. ä¿®æ”¹ç€è‰²å™¨</h2><p>å› ä¸ºæ˜¯é€åƒç´ ä¼ æ•°æ®ï¼Œæ‰€ä»¥å…ˆç”¨<code>attribute</code>å‹æ¥å—æ•°æ®ï¼Œç„¶åä¼ åˆ°<code>varying</code>ä¸­ä»¥ä¼ å…¥ç‰‡æ®µç€è‰²å™¨ä¸­ã€‚<br>åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­ä½¿ç”¨<code>sampler2D</code>ç±»å‹æ‰¿è½½<code>GL_TEXTURE</code>å¯¹è±¡ã€‚<code>texture2D</code>è·å–çº¹ç†å¯¹åº”åæ ‡ä¸Šçš„é¢œè‰²å€¼ã€‚</p><pre><code class="js">const vertexSource = `attribute vec2 aPosition;attribute vec2 aTexCoord;varying lowp vec2 vTexCoord;void main(){    vTexCoord = aTexCoord;    gl_Position=vec4(aPosition,0.0,1.0);}`;const fragmentSource = `varying lowp vec2 vTexCoord;uniform sampler2D uSampler;void main(){      gl_FragColor = texture2D(uSampler,vTexCoord);  }`;</code></pre><h2 id="3-çº¹ç†æ˜ å°„"><a href="#3-çº¹ç†æ˜ å°„" class="headerlink" title="3.çº¹ç†æ˜ å°„"></a>3.çº¹ç†æ˜ å°„</h2><p>æŒ‡å®šå›¾å½¢ä¸Šæ˜¾ç¤ºçš„çº¹ç†çš„åæ ‡ï¼ŒæŒ‰ç…§ç‚¹çš„é¡ºåºæ¥ã€‚</p><blockquote><p>2020.09.13ï¼šè¿™é‡Œæ­£æ–¹å½¢çš„ç‚¹åªå†™<code>x</code>å’Œ<code>y</code>æ˜¯å› ä¸ºä¸Šé¢çš„ç€è‰²å™¨é‡Œå·²ç»æŠŠ<code>z</code>è®¾å®šäº†ã€‚åŠå¹´è¿‡å»è‡ªå·±éƒ½å¿˜è®°äº† ğŸ˜…ã€‚</p></blockquote><pre><code class="js">//æ­£æ–¹å½¢çš„ç‚¹const vertices = [-0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5];//çº¹ç†å¯¹åº”åæ ‡const tex = [0, 0, 0, 1, 1, 0, 1, 1];</code></pre><p>ä¸Šæ¬¡å†™çš„ä¸€æ¬¡æ€§è¾“å…¥ï¼Œè¿™æ¬¡åˆ†åˆ«ç»‘å®šç¼“å†²ï¼š</p><pre><code class="js">function simpleBindBuffer(gl, shaderProgram, name, data, size) {  const buffer = gl.createBuffer();  gl.bindBuffer(gl.ARRAY_BUFFER, buffer);  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(data), gl.STATIC_DRAW);  const index = gl.getAttribLocation(shaderProgram, name);  gl.vertexAttribPointer(index, size, gl.FLOAT, false, 0, 0);  gl.enableVertexAttribArray(index);  return buffer;}//è®¾ç½®ç¼“å†²simpleBindBuffer(gl, shaderProgram, &quot;aPosition&quot;, vertices, 2);simpleBindBuffer(gl, shaderProgram, &quot;aTexCoord&quot;, tex, 2);</code></pre><p>è¿™æ ·å°±èƒ½åœ¨å¹³é¢ä¸Šè´´ä¸Šçº¹ç†äº†ã€‚</p><h2 id="4-é”™è¯¯"><a href="#4-é”™è¯¯" class="headerlink" title="4. é”™è¯¯"></a>4. é”™è¯¯</h2><blockquote><p>generateMipmap: The base level of the texture does not have power-of-two dimensions.</p></blockquote><p><code>webgl 1.0</code> åªèƒ½ç»™å›¾ç‰‡è¾¹é•¿ä¸º 2 çš„å¹‚çš„å›¾ç‰‡ç”Ÿæˆ mipmap, <code>webgl 2.0</code>å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½¿ç”¨ <code>webgl 2.0</code> éœ€è¦ <code>const gl = canvas.getContext(&quot;webgl2&quot;)</code>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebGL ç¬”è®°ï¼ˆ2ï¼‰ 3Dæ­£æ–¹ä½“</title>
      <link href="2020/03/08/webgl-note-2/"/>
      <url>2020/03/08/webgl-note-2/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šæ¬¡æ˜¯ç”»äº†ä¸€ä¸ªåŸºç¡€å›¾å½¢ï¼Œåœ¨ä¸Šæ¬¡çš„åŸºç¡€ä¸Šï¼Œè¿™æ¬¡ç”»ä¸ªæ­£æ–¹ä½“ã€‚</p><a id="more"></a><h2 id="çº¿æ¡†æ­£æ–¹ä½“"><a href="#çº¿æ¡†æ­£æ–¹ä½“" class="headerlink" title="çº¿æ¡†æ­£æ–¹ä½“"></a>çº¿æ¡†æ­£æ–¹ä½“</h2><p>å‡†å¤‡å¥½æ­£æ–¹ä½“çš„ç‚¹ï¼Œç”»çº¿æ®µæ‰€ä»¥æ¯”è¾ƒæ‚â€¦â€¦</p><pre><code class="js">const vertices=[1,1,1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,1,1,-1,1,-1,-1,-1,-1];</code></pre><p>ç„¶åå°±æ˜¯æœ‰å…³æ‘„å½±æœºï¼Œåæ ‡ç­‰ç­‰ç›¸å…³å†…å®¹äº†ã€‚ç›¸å…³æ¦‚å¿µæ•™ç¨‹å¯ä»¥çœ‹ <a href="https://learnopengl-cn.github.io/01%20Getting%20started/08%20Coordinate%20Systems/" target="_blank" rel="noopener">LearnOpenGL</a> ã€‚</p><p><del>çœ‹åˆ°çŸ©é˜µä¹˜æ³•ï¼Œæƒ³èµ·äº†è¢«è®ºæ–‡æ”¯é…çš„ææƒ§</del>ï¼Œå››ä¸ªåæ ‡ç³»ä¹‹ç±»çš„æ˜¯3Dåœºæ™¯çš„å…±è¯†äº†ã€‚</p><p>ä½¿ç”¨ <a href="http://glmatrix.net" target="_blank" rel="noopener">gl-matrix</a> åº“æ¥è¿›è¡ŒçŸ©é˜µçš„è¿ç®—ã€‚æœ€ç»ˆéœ€è¦ç‰©ä½“ï¼Œç›¸æœºï¼ŒæŠ•å½±ä¸‰ä¸ªçŸ©é˜µã€‚</p><pre><code class="js">  //ç‰©ä½“æœ¬èº«è½¬45åº¦  let model = glMatrix.mat4.create();  glMatrix.mat4.rotate(    model,    model,    45,    glMatrix.vec3.fromValues(0.0, 1.0, 0.0)  );  //ç›¸æœºå‘åç§»å››æ ¼  let camera = glMatrix.mat4.create();  glMatrix.mat4.translate(    camera,    camera,    glMatrix.vec3.fromValues(0.0, 0.0, -4.0)  );  //æŠ•å½±çŸ©é˜µ  let projection = glMatrix.mat4.create();  let ratio = 8 / 6;  glMatrix.mat4.perspective(projection, (75 * Math.PI) / 180, ratio, 0.1, 100);</code></pre><p>ä¿®æ”¹é¡¶ç‚¹ç€è‰²å™¨ï¼Œæ·»åŠ æ”¾ä»¥ä¸Šä¸‰ä¸ªçŸ©é˜µçš„å˜é‡ã€‚ç‚¹çš„æœ€ç»ˆä½ç½®ä¹Ÿæ”¹ä¸ºçŸ©é˜µä¹˜æ³•ç®—å‡ºã€‚</p><pre><code class="glsl">attribute vec3 pos;uniform mat4 model;uniform mat4 view;uniform mat4 proj;void main(){    gl_Position=proj * view * model *vec4(pos.x,pos.y,pos.z,1.0);}</code></pre><p>ç„¶åå°±æ˜¯æŠŠæ•°æ®ä¼ åˆ°ç€è‰²å™¨ä¸­ã€‚ç”±äºç”¨çš„æ˜¯<code>uniform</code>å‹å˜é‡ï¼ŒæŸ¥æ‰¾å˜é‡çš„å‡½æ•°ä¹Ÿä¸ä¸€æ ·ã€‚</p><pre><code class="js">//æ³¨ï¼šä¸‹é¢çš„è¦å†™åœ¨å¯ç”¨programä¹‹ågl.useProgram(shaderProgram);//çŸ©é˜µä¼ å…¥ç€è‰²å™¨//1.æ‰¾åˆ°å˜é‡çš„ä½ç½®let modelPosIndex = gl.getUniformLocation(shaderProgram, &quot;model&quot;);//2.ä¼ å€¼gl.uniformMatrix4fv(modelPosIndex,false,model);</code></pre><p><code>attribute</code>å‹æ˜¯åªèƒ½åœ¨é¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨çš„å˜é‡ç±»å‹ï¼Œä¸»è¦æè¿°é¡¶ç‚¹æ•°æ®ã€‚<code>uniform</code>å‹åœ¨é¡¶ç‚¹å’Œç‰‡æ®µç€è‰²å™¨å†…éƒ½å¯ä½¿ç”¨ï¼Œæè¿°é¢œè‰²ã€å…‰ç…§ç­‰ç­‰ä¿¡æ¯ã€‚</p><p>æŸ¥çœ‹ç»“æœï¼š</p><p><img src="/2020/03/08/webgl-note-2/webgl-2_1_20200307.png" alt="çº¿æ¡†æ­£æ–¹ä½“"></p><h2 id="å®å¿ƒæ­£æ–¹ä½“"><a href="#å®å¿ƒæ­£æ–¹ä½“" class="headerlink" title="å®å¿ƒæ­£æ–¹ä½“"></a>å®å¿ƒæ­£æ–¹ä½“</h2><p>ä¸Šé¢ç”»çº¿æ¡†çš„é¡¶ç‚¹é›†å®åœ¨æ˜¯å¤ªæ‰­æ›²äº†â€¦â€¦è¿™å›åšä¸ªçœŸæ­£çš„ä¸‰è§’ç‰‡ã€‚</p><pre><code class="js">const vertices=[1,1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,-1,1,-1,1,1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,1,1,-1,-1,1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,1,-1,1,1,1,1,-1,-1,1,-1,-1,1,1,1,1,-1,1,1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1];</code></pre><p>å°†ç»˜å›¾å‚æ•°æ”¹ä¸º<code>gl.drawArrays(gl.TRIANGLES, 0, 36);</code>ï¼Œç»“æœæ˜¯ç™½è‰²ä¸€ç‰‡çš„è½®å»“â€¦â€¦è¿™æ˜¯å½“ç„¶çš„å•¦ï¼å› ä¸ºå®å¿ƒç™½è‰²èåˆåœ¨ä¸€èµ·äº†ã€‚ä¸ºäº†æ›´æ¸…æ¥šçš„çœ‹è§ï¼Œå°è¯•ç»™å„ä¸ªé¢ä¸Šä¸åŒçš„é¢œè‰²ã€‚</p><p>é¦–å…ˆç»™<code>vertices</code>é‡ŒåŠ ä¸Šå„ä¸ªç‚¹çš„é¢œè‰²ï¼š</p><pre><code class="js">const vertices=[1,1,1,1,0,0,1,1,-1,1,0,0,-1,1,-1,1,0,0,1,1,1,1,0,0,-1,1,1,1,0,0,-1,1,-1,1,0,0,1,1,-1,1,1,1,1,-1,-1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,-1,-1,1,1,1,1,-1,1,1,1,1,1,-1,-1,0,1,0,1,-1,1,0,1,0,-1,-1,1,0,1,0,-1,-1,1,0,1,0,-1,-1,-1,0,1,0,1,-1,-1,0,1,0,-1,-1,1,0,0,1,-1,-1,-1,0,0,1,-1,1,1,0,0,1,-1,1,1,0,0,1,-1,1,-1,0,0,1,-1,-1,-1,0,0,1,1,-1,1,1,0,1,1,1,1,1,0,1,-1,-1,1,1,0,1,-1,-1,1,1,0,1,1,1,1,1,0,1,-1,1,1,1,0,1,1,-1,-1,1,1,0,1,1,-1,1,1,0,-1,-1,-1,1,1,0,-1,-1,-1,1,1,0,-1,1,-1,1,1,0,1,1,-1,1,1,0];</code></pre><p><code>uniform</code>å˜é‡æ˜¯å…¨å±€çš„ã€ä¸é¡¶ç‚¹æ— å…³çš„ï¼Œæ‰€ä»¥é¢œè‰²ä½¿ç”¨<code>attribute</code>å‹ã€‚ç„¶ååˆ©ç”¨<code>varying</code>å‹å˜é‡ä¼ ç»™ç‰‡æ®µç€è‰²å™¨ã€‚ä¿®æ”¹ç€è‰²å™¨ï¼ŒåŠ ä¸Šè¾“å…¥çš„é¢œè‰²:</p><pre><code class="glsl">attribute vec3 pos;attribute vec3 in_color;varying lowp vec3 color;uniform mat4 model;uniform mat4 view;uniform mat4 proj;void main(){    color = in_color;    gl_Position=proj * view * model *vec4(pos,1.0);}</code></pre><pre><code class="glsl">varying lowp vec3 color;void main(){      gl_FragColor = vec4(1.0,color.y,1.0,1.0);  }</code></pre><p>ä¿®æ”¹<code>vertices</code>çš„å€¼ï¼Œä½¿å…­ä¸ªæ•°å­—è¡¨ç¤ºä¸€ä¸ªç‚¹ï¼Œå‰ä¸‰ä¸ªå€¼ä¸ºä½ç½®ï¼Œåä¸‰ä¸ªå€¼ä¸ºé¢œè‰²ã€‚ä¿®æ”¹ä¼ å…¥æ•°æ®çš„åœ°æ–¹ã€‚<code>gl.vertexAttribPointer</code>çš„æœ€åä¸¤ä¸ªå‚æ•°ï¼š<code>æ­¥é•¿</code>ï¼šä¸€ç»„æ•°æ®çš„é•¿åº¦ï¼›<code>åç§»é‡</code>ï¼šå¼€å§‹åˆ°ç¬¬ä¸€ä¸ªæ­¤ç±»æ•°æ®çš„é•¿åº¦ã€‚</p><pre><code class="js">//floatå…ƒç´ é•¿åº¦  let size = Float32Array.BYTES_PER_ELEMENT;//è¾“å…¥ä½ç½®let index = gl.getAttribLocation(shaderProgram, &quot;pos&quot;);gl.vertexAttribPointer(index, 3, gl.FLOAT, false, 6 * size, 0);//è¾“å…¥é¢œè‰²let colorIndex = gl.getAttribLocation(shaderProgram, &quot;colors&quot;);gl.vertexAttribPointer(colorIndex, 3, gl.FLOAT, false, 6 * size, 3 * size);//å¯ç”¨å±æ€§gl.enableVertexAttribArray(index);gl.enableVertexAttribArray(colorIndex);</code></pre><p>æŸ¥çœ‹ç»“æœï¼Œå‘ç°é¢œè‰²å †å äº†â€¦â€¦æ·±åº¦æµ‹è¯•ï¼Œonï¼</p><pre><code class="js">gl.enable(gl.DEPTH_TEST);gl.clearDepth(1);</code></pre><p>æœ€åè°ƒä¸€ä¸‹ç‰©ä½“çš„æ—‹è½¬è§’åº¦ï¼Œå¥½çœ‹åˆ°æ›´å¤šçš„é¢ï¼š</p><p><img src="/2020/03/08/webgl-note-2/webgl-2_2_20200308.png" alt="å®å¿ƒæ­£æ–¹ä½“"></p><h2 id="ç´¢å¼•æ­£æ–¹ä½“"><a href="#ç´¢å¼•æ­£æ–¹ä½“" class="headerlink" title="ç´¢å¼•æ­£æ–¹ä½“"></a>ç´¢å¼•æ­£æ–¹ä½“</h2><p>å†™36ä¸ªç‚¹çš„æ­£æ–¹ä½“çš„ç¡®æŒºæŠ½é£çš„ã€‚åˆ©ç”¨<code>gl.drawElements</code>ï¼Œç”¨ç´¢å¼•æ¥ç”»ä¸€ç³»åˆ—ç‰©ä½“ï¼Œå®Œæˆä¸€ä¸ªçº¿æ¡†æ­£æ–¹ä½“ã€‚</p><p>ç»æµ‹è¯•ç”¨ç´¢å¼•ç”»çš„è¯æ— æ³•åˆ†å¼€è®¾ç½®é¢œè‰²ï¼ˆåƒä¸Šå›¾ä¸€æ ·ï¼‰ï¼Ÿ</p><pre><code class="js">//æ­£æ–¹ä½“çš„ç‚¹var vertices = [    -1, -1, -1,//    1, -1, -1,//    1, 1, -1,//    -1, 1, -1,//    -1, 1, 1,//    1, 1, 1,//    -1, -1, 1,//    1, -1, 1  ];//ç»„æˆé¢çš„ç‚¹ç´¢å¼• (12ä¸ªä¸‰è§’å½¢)const indices = [    1,2,5, 1,5,7,    1,2,3, 1,0,3,    0,3,4, 0,6,4,    6,4,7, 7,5,4,    6,7,0, 0,7,1,    4,5,3, 3,5,2];//...//æ­£æ–¹ä½“const buffer = gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER, buffer);gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);var index = gl.getAttribLocation(shaderProgram, &quot;pos&quot;);gl.vertexAttribPointer(index, 3, gl.FLOAT, false, 0, 0);const indexesBuffer = gl.createBuffer();//ä¼ å…¥ç´¢å¼•çš„æ—¶å€™ä½¿ç”¨ gl.ELEMENT_ARRAY_BUFFER ç±»å‹gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexesBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);gl.enableVertexAttribArray(index);//...//åˆ©ç”¨`gl.drawElements&#39;ï¼Œç”¨ç´¢å¼•æ¥ç”»ä¸€ç³»åˆ—ç‰©ä½“//ç±»å‹ï¼Œç»˜åˆ¶çš„ç‚¹æ•°ï¼Œæ•°æ®ç±»å‹ï¼Œoffset(ç¦»å¼€å§‹ç‚¹çš„åç§»é‡)gl.drawElements(gl.TRIANGLES, indices.length, gl.UNSIGNED_SHORT, 0);</code></pre><p><del>çœŸå®ç¬”è®°ï¼Œé™¤äº†æˆ‘æ²¡äººçœ‹å¾—æ‡‚</del></p>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WebGL ç¬”è®°</title>
      <link href="2020/03/05/webgl-note-1/"/>
      <url>2020/03/05/webgl-note-1/</url>
      
        <content type="html"><![CDATA[<p>åœ¨è¿™é‡Œä¸»è¦å†™ç‚¹è‡ªå·±çš„ç¬”è®°ã€‚<del>æœ€ç»ˆç›®æ ‡æ˜¯å†™ä¸ªåœ¨çº¿æµ‹è¯• Shader çš„å°å·¥å…·ã€‚ä¹‹å‰æœ‰çœ‹åˆ°è¿‡ç›¸ä¼¼çš„å·¥å…·ä½†æ˜¯ç½‘é¡µå§‹ç»ˆæ‰“ä¸å¼€â€¦â€¦æ‰€ä»¥è‡ªå·±å†™ä¸€ä¸ªå§ï¼Œä»¥åå¯èƒ½ï¼ˆï¼Ÿï¼‰ç”¨å¾—ä¸Šã€‚</del> flag å€’äº†ï¼Œå½“æ—¶æƒ³å¾—å¤ªç®€å•äº†ï¼ˆ</p><p>2020.12.25 å†™äº†ä¸€ä¸ªè¶…ç®€å•çš„ç‰ˆæœ¬ç”¨æ¥å­¦ä¹  ğŸ˜ƒã€‚</p><a id="more"></a><p>å‚è€ƒçš„æ˜¯<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Tutorial" target="_blank" rel="noopener">MDN çš„æ•™ç¨‹</a>å’Œ<a href="https://learnopengl-cn.github.io/" target="_blank" rel="noopener">LearnOpenGL</a>ã€‚</p><ul><li><p><code>WebGL</code>å†…å®¹åœ¨<code>canvas</code>ä¸­æ¸²æŸ“ã€‚</p></li><li><p><code>gl</code>ä¸Šä¸‹æ–‡ <code>const gl=canvas.getContext(&quot;webgl&quot;)</code></p></li><li><p>ç€è‰²å™¨åŒæ ·æ˜¯å­—ç¬¦ä¸²ã€‚ç®€å•çš„ç€è‰²å™¨</p><pre><code class="js">//æ³¨æ„åˆ†å·const vertexSource = `attribute vec3 pos;void main(){    gl_Position=vec4(pos.x,pos.y,pos.z,1.0);}`;const fragmentSource = `void main(){        gl_FragColor = vec4(1.0,1.0,1.0,1.0);    }`;</code></pre></li><li><p>ç¼–è¯‘ç€è‰²å™¨ï¼Œä¸¤ç§éƒ½éœ€è¦</p><pre><code class="js">//gl.VERTEX_SHADERæˆ–gl.FRAGMENT_SHADERconst vertexShader = gl.createShader(gl.VERTEX_SHADER);//sourceä¸ºä¹‹å‰å†™å¥½çš„ç€è‰²å™¨ä»£ç ï¼ˆå­—ç¬¦ä¸²ï¼‰gl.shaderSource(vertexShader, vertexSource);gl.compileShader(vertexShader); //void</code></pre></li><li><p>åˆ›å»ºç€è‰²å™¨ç¨‹åºï¼š</p><pre><code class="js">const shaderProgram = gl.createProgram();gl.attachShader(shaderProgram, vertexShader);gl.attachShader(shaderProgram, fragShader);gl.linkProgram(shaderProgram);</code></pre></li><li><p>æ¸²æŸ“å¯¹è±¡é¡¶ç‚¹ç»„ï¼ˆæ­£æ–¹å½¢ï¼‰</p><pre><code class="js">const vertices = [0.5, -0.5, 0, 0.5, 0.5, 0, -0.5, 0.5, 0, -0.5, -0.5, 0];</code></pre></li><li><p>åˆ›å»ºç¼“å†²å™¨å­˜å‚¨å¯¹è±¡é¡¶ç‚¹æ•°æ®:</p><pre><code class="js">//åˆå§‹åŒ–ä¸€ä¸ªbufferå¯¹è±¡buffer = gl.createBuffer();//å‚æ•°ä¸€ï¼šæŒ‡å®šç»‘å®šbufferç±»å‹ï¼Œå‚æ•°äºŒï¼šè¦ç»‘å®šçš„buffergl.bindBuffer(gl.ARRAY_BUFFER, buffer);//åˆ›å»ºbufferçš„æ•°æ®å­˜å‚¨åŒºåŸŸï¼šç±»å‹ï¼Œæºæ•°æ®ï¼Œä½¿ç”¨æ–¹æ³•ã€‚gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);</code></pre></li><li><p>é“¾æ¥ç€è‰²å™¨å’Œé¡¶ç‚¹æ•°æ®</p><pre><code class="js">//å‚æ•°ä¸ºé¡¶ç‚¹å±æ€§ç´¢å¼•ï¼Œæ¯ä¸ªé¡¶ç‚¹ä¸­ç»„æˆæ•°é‡ï¼Œæ•°æ®ç±»å‹ï¼Œæ˜¯å¦å½’ä¸€åŒ–ï¼Œæ­¥é•¿ï¼Œoffsetgl.vertexAttribPointer(0, 3, gl.FLOAT, false, 0, 0);//å¯ç”¨é¡¶ç‚¹å±æ€§ï¼Œå‚æ•°ä¸ºè¦æ¿€æ´»çš„é¡¶ç‚¹å±æ€§ç´¢å¼•//ä½¿ç”¨getAttribLocationè·å–ç´¢å¼•çš„ä¾‹å­var index = gl.getAttribLocation(shaderProgram, &quot;pos&quot;);gl.enableVertexAttribArray(index);</code></pre></li><li><p>æ¸²æŸ“åœºæ™¯</p><ul><li><p>æ¸…é™¤<code>canvas</code>:</p><pre><code class="js">gl.clearColor(0, 0, 0, 1); // è®¾ç½®æ¸…é™¤é¢œè‰²gl.clear(gl.COLOR_BUFFER_BIT);</code></pre></li><li><p>ç”»å›¾ï¼š</p><pre><code class="js">gl.useProgram(shaderProgram);gl.drawArrays(gl.LINE_LOOP, 0, 4);</code></pre></li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> Webå‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WebGL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2019/03/07/hello-world/"/>
      <url>2019/03/07/hello-world/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€ç¯‡åšå®¢ã€‚<br>å¦‚æœä¸å¼€ä»“åº“å†™åšå®¢çš„äº‹æƒ…å°±ä¼šä¸€ç›´æ‹–ï¼Œæ‰€ä»¥å…ˆå»ºä¸€ä¸ªã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¿— </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
